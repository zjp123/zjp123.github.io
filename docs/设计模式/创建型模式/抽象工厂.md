# ã€Šå‰ç«¯è®¾è®¡æ¨¡å¼å®æˆ˜æ‰‹å†Œã€‹

## ç¬¬äºŒç« ï¼šæŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factory Patternï¼‰

---

### ğŸ¯ ä¸€å¥è¯å¤§ç™½è¯

> **æŠ½è±¡å·¥å‚æ¨¡å¼å°±åƒå®œå®¶çš„"å…¨å±‹å®šåˆ¶"æœåŠ¡ï¼šä½ é€‰æ‹©"åŒ—æ¬§é£æ ¼"ï¼Œå®ƒä¼šç»™ä½ é…å¥—çš„æ²™å‘ã€èŒ¶å‡ ã€é¤æ¡Œã€ä¹¦æ¶â€”â€”æ‰€æœ‰å®¶å…·é£æ ¼ç»Ÿä¸€ã€‚ä½ ä¸éœ€è¦è‡ªå·±ä¸€ä»¶ä»¶æŒ‘ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒæ²™å‘æ˜¯åŒ—æ¬§é£ã€èŒ¶å‡ å´æ˜¯ä¸­å¼é£çš„å°´å°¬ã€‚**

å·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯"å•å“å®šåˆ¶"ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼æ˜¯"å…¨å®¶æ¡¶å¥—é¤"ã€‚

---

### ğŸ¤” å’Œå·¥å‚æ–¹æ³•æ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆææ¸…æ¥šè¿™ä¸¤ä¸ªæ¨¡å¼çš„åŒºåˆ«ï¼š

| å¯¹æ¯”é¡¹ | å·¥å‚æ–¹æ³•æ¨¡å¼ | æŠ½è±¡å·¥å‚æ¨¡å¼ |
|--------|-------------|-------------|
| **äº§å‡º** | ä¸€ä¸ªå·¥å‚ç”Ÿäº§**ä¸€ç§**äº§å“ | ä¸€ä¸ªå·¥å‚ç”Ÿäº§**ä¸€ç³»åˆ—ç›¸å…³**äº§å“ |
| **å…³æ³¨ç‚¹** | å•ä¸ªäº§å“çš„åˆ›å»º | ä¸€ç»„äº§å“ï¼ˆäº§å“æ—ï¼‰çš„åˆ›å»º |
| **ç±»æ¯”** | å¥¶èŒ¶åº—åªå–å¥¶èŒ¶ | å¥¶èŒ¶åº—å–å¥¶èŒ¶+å°åƒ+ç”œå“ï¼ˆå¥—é¤ï¼‰ |
| **å‰ç«¯åœºæ™¯** | æ ¹æ® type åˆ›å»ºä¸åŒè¡¨å•ç»„ä»¶ | æ ¹æ® theme åˆ›å»ºæ•´å¥— UI ç»„ä»¶ |

**è®°ä½è¿™ä¸ªå…¬å¼ï¼š**
```
å·¥å‚æ–¹æ³• = ä¸€ä¸ªå·¥å‚ â†’ ä¸€ç§äº§å“
æŠ½è±¡å·¥å‚ = ä¸€ä¸ªå·¥å‚ â†’ ä¸€æ—äº§å“ï¼ˆå¤šä¸ªç›¸å…³äº§å“ï¼‰
```

---

### ğŸ˜« å‰ç«¯ç—›ç‚¹ï¼šæ²¡æœ‰æŠ½è±¡å·¥å‚æ—¶çš„å™©æ¢¦

æƒ³è±¡è¿™ä¸ªåœºæ™¯ï¼šä½ åœ¨åšä¸€ä¸ª **æ”¯æŒå¤šä¸»é¢˜åˆ‡æ¢çš„ CRM ç³»ç»Ÿ**ï¼Œéœ€è¦æ”¯æŒã€Œé»˜è®¤ä¸»é¢˜ã€å’Œã€Œæš—é»‘ä¸»é¢˜ã€ã€‚

æ¯ç§ä¸»é¢˜ä¸‹éƒ½æœ‰ä¸€æ•´å¥—ç»„ä»¶ï¼šButtonã€Inputã€Cardã€Modal...

```tsx
// âŒ å™©æ¢¦ä»£ç ï¼šä¸»é¢˜åˆ¤æ–­æ•£è½åœ¨å„å¤„

// Button ç»„ä»¶é‡Œ
const Button = ({ theme, children }) => {
  if (theme === 'dark') {
    return <button className="btn-dark">{children}</button>;
  }
  return <button className="btn-light">{children}</button>;
};

// Input ç»„ä»¶é‡Œ
const Input = ({ theme, ...props }) => {
  if (theme === 'dark') {
    return <input className="input-dark" {...props} />;
  }
  return <input className="input-light" {...props} />;
};

// Card ç»„ä»¶é‡Œ
const Card = ({ theme, children }) => {
  if (theme === 'dark') {
    return <div className="card-dark">{children}</div>;
  }
  return <div className="card-light">{children}</div>;
};

// Modal ç»„ä»¶é‡Œ... åˆæ˜¯ä¸€å † if-else

// ä½¿ç”¨æ—¶ï¼Œæ¯ä¸ªç»„ä»¶éƒ½è¦ä¼  theme
<Button theme={currentTheme}>æäº¤</Button>
<Input theme={currentTheme} placeholder="è¯·è¾“å…¥" />
<Card theme={currentTheme}>å†…å®¹</Card>
```

**è¿™æ®µä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ**

| é—®é¢˜ | æè¿° |
|------|------|
| ğŸ”´ **é‡å¤åˆ¤æ–­** | æ¯ä¸ªç»„ä»¶éƒ½è¦å†™ theme åˆ¤æ–­é€»è¾‘ |
| ğŸ”´ **å®¹æ˜“é—æ¼** | æ–°åŠ ç»„ä»¶å¯èƒ½å¿˜è®°å¤„ç†æŸä¸ªä¸»é¢˜ |
| ğŸ”´ **é£æ ¼ä¸ä¸€è‡´é£é™©** | ä¸‡ä¸€ Button ç”¨äº†æš—é»‘ä¸»é¢˜ï¼ŒCard å¿˜äº†ä¼  themeï¼Œé¡µé¢å°±"ç²¾ç¥åˆ†è£‚"äº† |
| ğŸ”´ **æ‰©å±•å›°éš¾** | æ–°å¢ä¸€ä¸ª"é«˜å¯¹æ¯”åº¦ä¸»é¢˜"ï¼Ÿæ¯ä¸ªç»„ä»¶éƒ½è¦æ”¹ |
| ğŸ”´ **Props æ±¡æŸ“** | æ¯ä¸ªç»„ä»¶éƒ½è¦é€ä¼  themeï¼Œä»£ç å†—ä½™ |

---

### ğŸ’¡ æ¨¡å¼æ ¸å¿ƒæ¦‚å¿µ

æŠ½è±¡å·¥å‚æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š

> **æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬çš„å…·ä½“ç±»ã€‚**

ç”¨å¤§ç™½è¯è¯´å°±æ˜¯ï¼š
- æŠŠ"ä¸€æ•´å¥—ç›¸å…³ç»„ä»¶"æ‰“åŒ…æˆä¸€ä¸ª"å·¥å‚"
- åˆ‡æ¢ä¸»é¢˜ = åˆ‡æ¢å·¥å‚
- å·¥å‚å†…éƒ¨ä¿è¯æ‰€æœ‰ç»„ä»¶é£æ ¼ä¸€è‡´
- ä½¿ç”¨æ–¹åªéœ€è¦é€‰æ‹©"å“ªä¸ªå·¥å‚"ï¼Œä¸ç”¨å…³å¿ƒé‡Œé¢æœ‰ä»€ä¹ˆ

**ç±»æ¯”ç†è§£ï¼š**

```
æ™®é€šåšæ³•ï¼šè‡ªå·±å»è¶…å¸‚ä¹°åŒ—æ¬§é£æ²™å‘ã€åˆå»å¦ä¸€å®¶ä¹°èŒ¶å‡ ã€å†å»ç¬¬ä¸‰å®¶ä¹°é¤æ¡Œ
         â†’ é£æ ¼å¯èƒ½ä¸æ­é…

æŠ½è±¡å·¥å‚ï¼šé€‰æ‹©"å®œå®¶åŒ—æ¬§å¥—è£…"ï¼Œä¸€æ¬¡æ€§è·å¾—å…¨å¥—é…å¥—å®¶å…·
         â†’ é£æ ¼ä¿è¯ä¸€è‡´
```

**å…³é”®æ¦‚å¿µï¼š**
- **äº§å“æ—ï¼ˆProduct Familyï¼‰**ï¼šä¸€ç»„ç›¸å…³çš„äº§å“ï¼Œå¦‚ã€Œæš—é»‘ä¸»é¢˜ã€ä¸‹çš„ Buttonã€Inputã€Card
- **äº§å“ç­‰çº§ï¼ˆProduct Hierarchyï¼‰**ï¼šåŒä¸€ç±»äº§å“çš„ä¸åŒå®ç°ï¼Œå¦‚å„ä¸»é¢˜ä¸‹çš„ Button

```
                    Button      Input       Card       Modal
                    â”€â”€â”€â”€â”€â”€      â”€â”€â”€â”€â”€       â”€â”€â”€â”€       â”€â”€â”€â”€â”€
é»˜è®¤ä¸»é¢˜å·¥å‚ â†’      LightBtn    LightInput  LightCard  LightModal  â† äº§å“æ—1
æš—é»‘ä¸»é¢˜å·¥å‚ â†’      DarkBtn     DarkInput   DarkCard   DarkModal   â† äº§å“æ—2
é«˜å¯¹æ¯”ä¸»é¢˜å·¥å‚ â†’    ContrastBtn ContrastInp ContrastCd ContrastMdl â† äº§å“æ—3
                    â†“           â†“           â†“          â†“
                    äº§å“ç­‰çº§1   äº§å“ç­‰çº§2    äº§å“ç­‰çº§3   äº§å“ç­‰çº§4
```

---

### ğŸ”§ å‰ç«¯å®æˆ˜æ¡ˆä¾‹ï¼šå¤šä¸»é¢˜ UI ç»„ä»¶å·¥å‚

#### åœºæ™¯æè¿°

æˆ‘ä»¬è¦å®ç°ä¸€ä¸ª **æ”¯æŒä¸»é¢˜åˆ‡æ¢çš„ UI ç³»ç»Ÿ**ï¼ŒåŒ…å« Buttonã€Inputã€Card ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ï¼Œæ”¯æŒã€Œé»˜è®¤ä¸»é¢˜ã€å’Œã€Œæš—é»‘ä¸»é¢˜ã€ã€‚

#### Step 1: å®šä¹‰äº§å“æ¥å£ï¼ˆç»„ä»¶å¥‘çº¦ï¼‰

```tsx
// types/themeFactory.ts

import { ReactNode, InputHTMLAttributes, ButtonHTMLAttributes } from 'react';

/**
 * Button ç»„ä»¶çš„å±æ€§æ¥å£
 */
export interface IButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'primary' | 'secondary' | 'danger';
  size?: 'small' | 'medium' | 'large';
  children: ReactNode;
}

/**
 * Input ç»„ä»¶çš„å±æ€§æ¥å£
 */
export interface IInputProps extends InputHTMLAttributes<HTMLInputElement> {
  label?: string;
  error?: string;
}

/**
 * Card ç»„ä»¶çš„å±æ€§æ¥å£
 */
export interface ICardProps {
  title?: string;
  children: ReactNode;
  footer?: ReactNode;
}

/**
 * æŠ½è±¡å·¥å‚æ¥å£ â€”â€” è¿™æ˜¯å…³é”®ï¼
 * å®šä¹‰äº†ä¸€ä¸ªä¸»é¢˜å·¥å‚å¿…é¡»èƒ½åˆ›å»ºå“ªäº›ç»„ä»¶
 */
export interface IThemeFactory {
  createButton: (props: IButtonProps) => ReactNode;
  createInput: (props: IInputProps) => ReactNode;
  createCard: (props: ICardProps) => ReactNode;
}
```

#### Step 2: å®ç°é»˜è®¤ä¸»é¢˜å·¥å‚

```tsx
// factories/lightThemeFactory.tsx

import React from 'react';
import { IThemeFactory, IButtonProps, IInputProps, ICardProps } from '../types/themeFactory';

/**
 * é»˜è®¤ä¸»é¢˜çš„ Button ç»„ä»¶
 */
const LightButton: React.FC<IButtonProps> = ({ 
  variant = 'primary', 
  size = 'medium', 
  children,
  ...rest 
}) => {
  const baseStyles: React.CSSProperties = {
    padding: size === 'small' ? '4px 12px' : size === 'large' ? '12px 24px' : '8px 16px',
    fontSize: size === 'small' ? '12px' : size === 'large' ? '16px' : '14px',
    borderRadius: '6px',
    border: 'none',
    cursor: 'pointer',
    transition: 'all 0.2s ease',
  };

  const variantStyles: Record<string, React.CSSProperties> = {
    primary: { backgroundColor: '#1890ff', color: '#fff' },
    secondary: { backgroundColor: '#f0f0f0', color: '#333' },
    danger: { backgroundColor: '#ff4d4f', color: '#fff' },
  };

  return (
    <button style={{ ...baseStyles, ...variantStyles[variant] }} {...rest}>
      {children}
    </button>
  );
};

/**
 * é»˜è®¤ä¸»é¢˜çš„ Input ç»„ä»¶
 */
const LightInput: React.FC<IInputProps> = ({ label, error, ...rest }) => {
  const styles: React.CSSProperties = {
    padding: '8px 12px',
    fontSize: '14px',
    border: error ? '1px solid #ff4d4f' : '1px solid #d9d9d9',
    borderRadius: '6px',
    backgroundColor: '#fff',
    color: '#333',
    width: '100%',
    outline: 'none',
  };

  return (
    <div style={{ marginBottom: '16px' }}>
      {label && (
        <label style={{ display: 'block', marginBottom: '4px', color: '#333', fontSize: '14px' }}>
          {label}
        </label>
      )}
      <input style={styles} {...rest} />
      {error && <span style={{ color: '#ff4d4f', fontSize: '12px' }}>{error}</span>}
    </div>
  );
};

/**
 * é»˜è®¤ä¸»é¢˜çš„ Card ç»„ä»¶
 */
const LightCard: React.FC<ICardProps> = ({ title, children, footer }) => {
  return (
    <div style={{
      backgroundColor: '#fff',
      borderRadius: '8px',
      boxShadow: '0 2px 8px rgba(0, 0, 0, 0.1)',
      overflow: 'hidden',
    }}>
      {title && (
        <div style={{
          padding: '16px 24px',
          borderBottom: '1px solid #f0f0f0',
          fontSize: '16px',
          fontWeight: 600,
          color: '#333',
        }}>
          {title}
        </div>
      )}
      <div style={{ padding: '24px', color: '#333' }}>
        {children}
      </div>
      {footer && (
        <div style={{
          padding: '12px 24px',
          borderTop: '1px solid #f0f0f0',
          backgroundColor: '#fafafa',
        }}>
          {footer}
        </div>
      )}
    </div>
  );
};

/**
 * é»˜è®¤ä¸»é¢˜å·¥å‚
 * ä¸€ä¸ªå·¥å‚ï¼Œç”Ÿäº§ä¸€æ•´å¥—é»˜è®¤ä¸»é¢˜çš„ç»„ä»¶
 */
export const lightThemeFactory: IThemeFactory = {
  createButton: (props) => <LightButton {...props} />,
  createInput: (props) => <LightInput {...props} />,
  createCard: (props) => <LightCard {...props} />,
};
```

#### Step 3: å®ç°æš—é»‘ä¸»é¢˜å·¥å‚

```tsx
// factories/darkThemeFactory.tsx

import React from 'react';
import { IThemeFactory, IButtonProps, IInputProps, ICardProps } from '../types/themeFactory';

/**
 * æš—é»‘ä¸»é¢˜çš„ Button ç»„ä»¶
 */
const DarkButton: React.FC<IButtonProps> = ({ 
  variant = 'primary', 
  size = 'medium', 
  children,
  ...rest 
}) => {
  const baseStyles: React.CSSProperties = {
    padding: size === 'small' ? '4px 12px' : size === 'large' ? '12px 24px' : '8px 16px',
    fontSize: size === 'small' ? '12px' : size === 'large' ? '16px' : '14px',
    borderRadius: '6px',
    border: '1px solid #434343',
    cursor: 'pointer',
    transition: 'all 0.2s ease',
  };

  const variantStyles: Record<string, React.CSSProperties> = {
    primary: { backgroundColor: '#177ddc', color: '#fff', borderColor: '#177ddc' },
    secondary: { backgroundColor: '#303030', color: '#fff' },
    danger: { backgroundColor: '#a61d24', color: '#fff', borderColor: '#a61d24' },
  };

  return (
    <button style={{ ...baseStyles, ...variantStyles[variant] }} {...rest}>
      {children}
    </button>
  );
};

/**
 * æš—é»‘ä¸»é¢˜çš„ Input ç»„ä»¶
 */
const DarkInput: React.FC<IInputProps> = ({ label, error, ...rest }) => {
  const styles: React.CSSProperties = {
    padding: '8px 12px',
    fontSize: '14px',
    border: error ? '1px solid #a61d24' : '1px solid #434343',
    borderRadius: '6px',
    backgroundColor: '#1f1f1f',
    color: '#fff',
    width: '100%',
    outline: 'none',
  };

  return (
    <div style={{ marginBottom: '16px' }}>
      {label && (
        <label style={{ display: 'block', marginBottom: '4px', color: '#d9d9d9', fontSize: '14px' }}>
          {label}
        </label>
      )}
      <input style={styles} {...rest} />
      {error && <span style={{ color: '#a61d24', fontSize: '12px' }}>{error}</span>}
    </div>
  );
};

/**
 * æš—é»‘ä¸»é¢˜çš„ Card ç»„ä»¶
 */
const DarkCard: React.FC<ICardProps> = ({ title, children, footer }) => {
  return (
    <div style={{
      backgroundColor: '#1f1f1f',
      borderRadius: '8px',
      border: '1px solid #303030',
      overflow: 'hidden',
    }}>
      {title && (
        <div style={{
          padding: '16px 24px',
          borderBottom: '1px solid #303030',
          fontSize: '16px',
          fontWeight: 600,
          color: '#fff',
        }}>
          {title}
        </div>
      )}
      <div style={{ padding: '24px', color: '#d9d9d9' }}>
        {children}
      </div>
      {footer && (
        <div style={{
          padding: '12px 24px',
          borderTop: '1px solid #303030',
          backgroundColor: '#141414',
        }}>
          {footer}
        </div>
      )}
    </div>
  );
};

/**
 * æš—é»‘ä¸»é¢˜å·¥å‚
 * ä¸€ä¸ªå·¥å‚ï¼Œç”Ÿäº§ä¸€æ•´å¥—æš—é»‘ä¸»é¢˜çš„ç»„ä»¶
 */
export const darkThemeFactory: IThemeFactory = {
  createButton: (props) => <DarkButton {...props} />,
  createInput: (props) => <DarkInput {...props} />,
  createCard: (props) => <DarkCard {...props} />,
};
```

#### Step 4: åˆ›å»ºä¸»é¢˜å·¥å‚æ³¨å†Œä¸­å¿ƒ

```tsx
// factories/themeFactoryRegistry.ts

import { IThemeFactory } from '../types/themeFactory';
import { lightThemeFactory } from './lightThemeFactory';
import { darkThemeFactory } from './darkThemeFactory';

export type ThemeType = 'light' | 'dark';

/**
 * ä¸»é¢˜å·¥å‚æ³¨å†Œè¡¨
 * 
 * ç±»æ¯”ï¼šè¿™æ˜¯ä¸€ä¸ª"å®¶å…·åŸ"ï¼Œé‡Œé¢æœ‰å¤šä¸ªå“ç‰Œå±•å…
 * - æƒ³è¦åŒ—æ¬§é£ï¼Ÿå»å®œå®¶å±•å…
 * - æƒ³è¦ä¸­å¼é£ï¼Ÿå»çº¢æœ¨å±•å…
 * - æƒ³è¦æš—é»‘é£ï¼Ÿå»æš—é»‘å±•å…
 */
const themeFactories: Record<ThemeType, IThemeFactory> = {
  light: lightThemeFactory,
  dark: darkThemeFactory,
};

/**
 * è·å–æŒ‡å®šä¸»é¢˜çš„å·¥å‚
 */
export const getThemeFactory = (theme: ThemeType): IThemeFactory => {
  const factory = themeFactories[theme];
  
  if (!factory) {
    console.warn(`æœªæ‰¾åˆ°ä¸»é¢˜ "${theme}" çš„å·¥å‚ï¼Œä½¿ç”¨é»˜è®¤ä¸»é¢˜`);
    return themeFactories.light;
  }
  
  return factory;
};

/**
 * æ³¨å†Œæ–°çš„ä¸»é¢˜å·¥å‚ï¼ˆæ”¯æŒæ‰©å±•ï¼‰
 */
export const registerThemeFactory = (theme: string, factory: IThemeFactory) => {
  (themeFactories as Record<string, IThemeFactory>)[theme] = factory;
};
```

#### Step 5: åˆ›å»º Theme Context å’Œ Provider

```tsx
// context/ThemeContext.tsx

import React, { createContext, useContext, useState, ReactNode } from 'react';
import { IThemeFactory } from '../types/themeFactory';
import { getThemeFactory, ThemeType } from '../factories/themeFactoryRegistry';

interface ThemeContextValue {
  theme: ThemeType;
  factory: IThemeFactory;
  setTheme: (theme: ThemeType) => void;
}

const ThemeContext = createContext<ThemeContextValue | null>(null);

interface ThemeProviderProps {
  children: ReactNode;
  defaultTheme?: ThemeType;
}

/**
 * ä¸»é¢˜ Provider
 * 
 * åœ¨åº”ç”¨é¡¶å±‚ä½¿ç”¨ï¼Œæ‰€æœ‰å­ç»„ä»¶éƒ½èƒ½è·å–åˆ°å½“å‰ä¸»é¢˜çš„å·¥å‚
 */
export const ThemeProvider: React.FC<ThemeProviderProps> = ({ 
  children, 
  defaultTheme = 'light' 
}) => {
  const [theme, setTheme] = useState<ThemeType>(defaultTheme);
  
  const value: ThemeContextValue = {
    theme,
    factory: getThemeFactory(theme),
    setTheme,
  };
  
  // æ ¹æ®ä¸»é¢˜è®¾ç½®èƒŒæ™¯è‰²
  const backgroundColor = theme === 'dark' ? '#141414' : '#f5f5f5';
  
  return (
    <ThemeContext.Provider value={value}>
      <div style={{ backgroundColor, minHeight: '100vh', transition: 'background-color 0.3s' }}>
        {children}
      </div>
    </ThemeContext.Provider>
  );
};

/**
 * è·å–ä¸»é¢˜å·¥å‚çš„ Hook
 */
export const useTheme = () => {
  const context = useContext(ThemeContext);
  
  if (!context) {
    throw new Error('useTheme å¿…é¡»åœ¨ ThemeProvider å†…éƒ¨ä½¿ç”¨');
  }
  
  return context;
};
```

#### Step 6: å°è£…ä¾¿æ·ç»„ä»¶ï¼ˆå¯é€‰ä½†æ¨èï¼‰

```tsx
// components/themed/index.tsx

import React from 'react';
import { useTheme } from '../../context/ThemeContext';
import { IButtonProps, IInputProps, ICardProps } from '../../types/themeFactory';

/**
 * ä¸»é¢˜æ„ŸçŸ¥çš„ Button ç»„ä»¶
 * 
 * ä½¿ç”¨æ–¹åªéœ€è¦ <ThemedButton>ï¼Œä¸éœ€è¦å…³å¿ƒå½“å‰æ˜¯ä»€ä¹ˆä¸»é¢˜
 */
export const ThemedButton: React.FC<IButtonProps> = (props) => {
  const { factory } = useTheme();
  return <>{factory.createButton(props)}</>;
};

/**
 * ä¸»é¢˜æ„ŸçŸ¥çš„ Input ç»„ä»¶
 */
export const ThemedInput: React.FC<IInputProps> = (props) => {
  const { factory } = useTheme();
  return <>{factory.createInput(props)}</>;
};

/**
 * ä¸»é¢˜æ„ŸçŸ¥çš„ Card ç»„ä»¶
 */
export const ThemedCard: React.FC<ICardProps> = (props) => {
  const { factory } = useTheme();
  return <>{factory.createCard(props)}</>;
};
```

#### Step 7: ä¸šåŠ¡ç»„ä»¶ä¸­ä½¿ç”¨

```tsx
// pages/LoginPage.tsx

import React, { useState } from 'react';
import { ThemedButton, ThemedInput, ThemedCard } from '../components/themed';
import { useTheme } from '../context/ThemeContext';

/**
 * ç™»å½•é¡µé¢
 * 
 * æ ¸å¿ƒäº®ç‚¹ï¼š
 * - ç»„ä»¶å®Œå…¨ä¸å…³å¿ƒå½“å‰æ˜¯ä»€ä¹ˆä¸»é¢˜
 * - åˆ‡æ¢ä¸»é¢˜æ—¶ï¼Œæ‰€æœ‰ç»„ä»¶è‡ªåŠ¨æ›´æ–°ï¼Œé£æ ¼ä¿è¯ä¸€è‡´
 * - ä¸å­˜åœ¨"Button æ˜¯æš—é»‘é£ã€Input æ˜¯é»˜è®¤é£"çš„å°´å°¬
 */
export const LoginPage: React.FC = () => {
  const { theme, setTheme } = useTheme();
  const [formData, setFormData] = useState({ username: '', password: '' });

  const handleSubmit = () => {
    console.log('ç™»å½•æ•°æ®:', formData);
    alert(`ç”¨æˆ·å: ${formData.username}`);
  };

  return (
    <div style={{ 
      display: 'flex', 
      justifyContent: 'center', 
      alignItems: 'center', 
      minHeight: '100vh',
      padding: '20px',
    }}>
      <div style={{ width: '100%', maxWidth: '400px' }}>
        {/* ä¸»é¢˜åˆ‡æ¢æŒ‰é’® */}
        <div style={{ marginBottom: '20px', textAlign: 'right' }}>
          <ThemedButton
            variant="secondary"
            size="small"
            onClick={() => setTheme(theme === 'light' ? 'dark' : 'light')}
          >
            åˆ‡æ¢åˆ°{theme === 'light' ? 'æš—é»‘' : 'é»˜è®¤'}ä¸»é¢˜
          </ThemedButton>
        </div>

        {/* ç™»å½•å¡ç‰‡ */}
        <ThemedCard
          title="ç”¨æˆ·ç™»å½•"
          footer={
            <div style={{ textAlign: 'right' }}>
              <ThemedButton variant="primary" onClick={handleSubmit}>
                ç™»å½•
              </ThemedButton>
            </div>
          }
        >
          <ThemedInput
            label="ç”¨æˆ·å"
            placeholder="è¯·è¾“å…¥ç”¨æˆ·å"
            value={formData.username}
            onChange={(e) => setFormData({ ...formData, username: e.target.value })}
          />
          <ThemedInput
            label="å¯†ç "
            type="password"
            placeholder="è¯·è¾“å…¥å¯†ç "
            value={formData.password}
            onChange={(e) => setFormData({ ...formData, password: e.target.value })}
          />
        </ThemedCard>
      </div>
    </div>
  );
};
```

#### Step 8: åº”ç”¨å…¥å£

```tsx
// App.tsx

import React from 'react';
import { ThemeProvider } from './context/ThemeContext';
import { LoginPage } from './pages/LoginPage';

const App: React.FC = () => {
  return (
    <ThemeProvider defaultTheme="light">
      <LoginPage />
    </ThemeProvider>
  );
};

export default App;
```

---

### ğŸš€ æ‰©å±•ï¼šå¦‚ä½•æ–°å¢ä¸€ä¸ªä¸»é¢˜ï¼Ÿ

å‡è®¾äº§å“ç»ç†è¯´è¦åŠ ä¸€ä¸ª"é«˜å¯¹æ¯”åº¦ä¸»é¢˜"ï¼ˆä¸ºè§†åŠ›éšœç¢ç”¨æˆ·è®¾è®¡ï¼‰ï¼š

```tsx
// factories/highContrastThemeFactory.tsx

import React from 'react';
import { IThemeFactory } from '../types/themeFactory';

// é«˜å¯¹æ¯”åº¦ä¸»é¢˜çš„ç»„ä»¶å®ç°...
const HighContrastButton = ({ children, ...props }) => (
  <button style={{
    backgroundColor: '#000',
    color: '#fff',
    border: '3px solid #fff',
    // ... é«˜å¯¹æ¯”åº¦æ ·å¼
  }} {...props}>
    {children}
  </button>
);

// ... å…¶ä»–ç»„ä»¶

export const highContrastFactory: IThemeFactory = {
  createButton: (props) => <HighContrastButton {...props} />,
  createInput: (props) => <HighContrastInput {...props} />,
  createCard: (props) => <HighContrastCard {...props} />,
};

// æ³¨å†Œæ–°ä¸»é¢˜
import { registerThemeFactory } from './themeFactoryRegistry';
registerThemeFactory('highContrast', highContrastFactory);
```

**æå®šï¼åŸæœ‰çš„ Light å’Œ Dark å·¥å‚ä¸€è¡Œä¸æ”¹ã€‚** ğŸ‰

---

### ğŸ’¼ çœŸå®ä¸šåŠ¡åœºæ™¯

#### åœºæ™¯ä¸€ï¼šå¤šå“ç‰Œ/å¤šç§Ÿæˆ·ç³»ç»Ÿ

```tsx
// ä¸åŒå“ç‰Œæœ‰ä¸åŒçš„ UI é£æ ¼
const brandFactories = {
  'brand-a': brandAFactory,  // å“ç‰Œ A çš„ç»„ä»¶æ—ï¼ˆè“è‰²ç³»ï¼‰
  'brand-b': brandBFactory,  // å“ç‰Œ B çš„ç»„ä»¶æ—ï¼ˆç»¿è‰²ç³»ï¼‰
  'brand-c': brandCFactory,  // å“ç‰Œ C çš„ç»„ä»¶æ—ï¼ˆç´«è‰²ç³»ï¼‰
};

// æ ¹æ®ç”¨æˆ·æ‰€å±å“ç‰Œï¼Œä½¿ç”¨å¯¹åº”çš„å·¥å‚
const factory = brandFactories[user.brand];
```

#### åœºæ™¯äºŒï¼šè·¨å¹³å°ç»„ä»¶

```tsx
// PC ç«¯å’Œç§»åŠ¨ç«¯ä½¿ç”¨ä¸åŒçš„ç»„ä»¶å®ç°
const platformFactories = {
  desktop: desktopFactory,  // PC ç«¯ç»„ä»¶æ—ï¼ˆantdï¼‰
  mobile: mobileFactory,    // ç§»åŠ¨ç«¯ç»„ä»¶æ—ï¼ˆantd-mobileï¼‰
};

// æ ¹æ®è®¾å¤‡ç±»å‹é€‰æ‹©å·¥å‚
const factory = platformFactories[isMobile ? 'mobile' : 'desktop'];
```

#### åœºæ™¯ä¸‰ï¼šA/B æµ‹è¯•

```tsx
// ä¸åŒçš„å®éªŒç»„ä½¿ç”¨ä¸åŒçš„ UI æ–¹æ¡ˆ
const experimentFactories = {
  control: controlFactory,     // å¯¹ç…§ç»„ï¼ˆåŸç‰ˆ UIï¼‰
  variant_a: variantAFactory,  // å®éªŒç»„ Aï¼ˆæ–°ç‰ˆæŒ‰é’®ï¼‰
  variant_b: variantBFactory,  // å®éªŒç»„ Bï¼ˆæ–°ç‰ˆè¡¨å•ï¼‰
};

// æ ¹æ®ç”¨æˆ·åˆ†ç»„é€‰æ‹©å·¥å‚
const factory = experimentFactories[user.experimentGroup];
```

---

### ğŸ“Š æ¨¡å¼æ€»ç»“

#### âœ… ä¼˜ç‚¹

| ä¼˜ç‚¹ | è¯´æ˜ |
|------|------|
| **äº§å“æ—ä¸€è‡´æ€§** | åŒä¸€ä¸ªå·¥å‚ç”Ÿäº§çš„ç»„ä»¶ï¼Œé£æ ¼ä¿è¯ç»Ÿä¸€ |
| **éš”ç¦»å…·ä½“å®ç°** | ä½¿ç”¨æ–¹ä¸éœ€è¦çŸ¥é“å…·ä½“çš„ç»„ä»¶ç±» |
| **æ˜“äºåˆ‡æ¢"æ•´å¥—"** | åˆ‡æ¢ä¸»é¢˜åªéœ€è¦æ¢ä¸€ä¸ªå·¥å‚ï¼Œæ‰€æœ‰ç»„ä»¶è‡ªåŠ¨æ›´æ–° |
| **ç¬¦åˆå¼€é—­åŸåˆ™** | æ–°å¢ä¸»é¢˜åªéœ€è¦æ–°å¢å·¥å‚ï¼Œä¸æ”¹ç°æœ‰ä»£ç  |
| **æ”¯æŒè¿è¡Œæ—¶åˆ‡æ¢** | å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ‡æ¢å·¥å‚ |

#### âŒ ç¼ºç‚¹

| ç¼ºç‚¹ | è¯´æ˜ |
|------|------|
| **äº§å“æ—æ‰©å±•å›°éš¾** | å¦‚æœè¦ç»™æ‰€æœ‰å·¥å‚æ–°å¢ä¸€ç§äº§å“ï¼ˆå¦‚ Modalï¼‰ï¼Œæ¯ä¸ªå·¥å‚éƒ½è¦æ”¹ |
| **ä»£ç é‡è¾ƒå¤§** | æ¯ä¸ªå·¥å‚éƒ½è¦å®ç°å®Œæ•´çš„äº§å“æ— |
| **ç†è§£æˆæœ¬é«˜** | æ–°äººéœ€è¦ç†è§£"äº§å“æ—"çš„æ¦‚å¿µ |
| **è¿‡åº¦è®¾è®¡é£é™©** | ç®€å•åœºæ™¯ä¸‹å¯èƒ½æ˜¾å¾—ç¹ç |

#### ğŸ¯ é€‚ç”¨åœºæ™¯

| åœºæ™¯ | ç¤ºä¾‹ |
|------|------|
| **ä¸»é¢˜ç³»ç»Ÿ** | é»˜è®¤ä¸»é¢˜ã€æš—é»‘ä¸»é¢˜ã€é«˜å¯¹æ¯”åº¦ä¸»é¢˜ |
| **å¤šå“ç‰Œç³»ç»Ÿ** | å“ç‰Œ Aã€å“ç‰Œ B å„æœ‰ä¸€å¥— UI |
| **è·¨å¹³å° UI** | PC ç«¯ç»„ä»¶æ—ã€ç§»åŠ¨ç«¯ç»„ä»¶æ— |
| **A/B æµ‹è¯•** | å¯¹ç…§ç»„ UIã€å®éªŒç»„ UI |
| **å›½é™…åŒ– UI** | ä¸åŒåœ°åŒºä½¿ç”¨ä¸åŒçš„ç»„ä»¶é£æ ¼ |

#### ğŸš« ä¸é€‚ç”¨åœºæ™¯

- åªæœ‰ä¸€ç§"äº§å“æ—"ï¼Œä¸éœ€è¦åˆ‡æ¢
- äº§å“æ—ä¸­çš„äº§å“ç»å¸¸å˜åŠ¨ï¼ˆä»Šå¤© 3 ä¸ªç»„ä»¶ï¼Œæ˜å¤© 10 ä¸ªï¼‰
- å„äº§å“ä¹‹é—´æ²¡æœ‰å…³è”æ€§ï¼Œä¸éœ€è¦ä¿è¯ä¸€è‡´æ€§

---

### ğŸ¤” é€‰æ‹©å»ºè®®ï¼šä»€ä¹ˆæ—¶å€™ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼ï¼Ÿ

é—®è‡ªå·±è¿™å‡ ä¸ªé—®é¢˜ï¼š

```
1. ä½ æ˜¯å¦éœ€è¦åˆ›å»º"ä¸€ç³»åˆ—ç›¸å…³çš„ç»„ä»¶"ï¼Œè€Œä¸æ˜¯å•ä¸ªç»„ä»¶ï¼Ÿ
   â†’ æ˜¯çš„è¯ï¼Œè€ƒè™‘æŠ½è±¡å·¥å‚

2. ä½ æ˜¯å¦éœ€è¦ä¿è¯è¿™äº›ç»„ä»¶çš„"é£æ ¼ä¸€è‡´æ€§"ï¼Ÿ
   â†’ æ˜¯çš„è¯ï¼Œè€ƒè™‘æŠ½è±¡å·¥å‚

3. ä½ æ˜¯å¦éœ€è¦æ”¯æŒ"æ•´å¥—åˆ‡æ¢"ï¼ˆå¦‚ä¸»é¢˜åˆ‡æ¢ã€å“ç‰Œåˆ‡æ¢ï¼‰ï¼Ÿ
   â†’ æ˜¯çš„è¯ï¼Œè€ƒè™‘æŠ½è±¡å·¥å‚

4. ä½ çš„"äº§å“æ—"æ˜¯å¦ç›¸å¯¹ç¨³å®šï¼ˆç»„ä»¶ç§ç±»ä¸ä¼šé¢‘ç¹å¢å‡ï¼‰ï¼Ÿ
   â†’ æ˜¯çš„è¯ï¼Œé€‚åˆç”¨æŠ½è±¡å·¥å‚
```

---

### ğŸ“ æ–‡ä»¶ç»“æ„å‚è€ƒ

```
src/
â”œâ”€â”€ types/
â”‚   â””â”€â”€ themeFactory.ts              # äº§å“æ¥å£å®šä¹‰
â”œâ”€â”€ factories/
â”‚   â”œâ”€â”€ themeFactoryRegistry.ts      # å·¥å‚æ³¨å†Œä¸­å¿ƒ
â”‚   â”œâ”€â”€ lightThemeFactory.tsx        # é»˜è®¤ä¸»é¢˜å·¥å‚
â”‚   â”œâ”€â”€ darkThemeFactory.tsx         # æš—é»‘ä¸»é¢˜å·¥å‚
â”‚   â””â”€â”€ highContrastThemeFactory.tsx # é«˜å¯¹æ¯”åº¦ä¸»é¢˜å·¥å‚ï¼ˆæ‰©å±•ï¼‰
â”œâ”€â”€ context/
â”‚   â””â”€â”€ ThemeContext.tsx             # ä¸»é¢˜ä¸Šä¸‹æ–‡
â”œâ”€â”€ components/
â”‚   â””â”€â”€ themed/
â”‚       â””â”€â”€ index.tsx                # ä¸»é¢˜æ„ŸçŸ¥ç»„ä»¶
â””â”€â”€ pages/
    â””â”€â”€ LoginPage.tsx                # ä¸šåŠ¡é¡µé¢
```

---

### ğŸ”„ ä¸å·¥å‚æ–¹æ³•æ¨¡å¼çš„é€‰æ‹©

| åœºæ™¯ | æ¨èæ¨¡å¼ |
|------|---------|
| æ ¹æ® type åˆ›å»ºå•ä¸ªç»„ä»¶ | å·¥å‚æ–¹æ³•æ¨¡å¼ |
| æ ¹æ® theme åˆ›å»ºä¸€å¥—ç»„ä»¶ | æŠ½è±¡å·¥å‚æ¨¡å¼ |
| ç»„ä»¶ä¹‹é—´æ²¡æœ‰å…³è” | å·¥å‚æ–¹æ³•æ¨¡å¼ |
| ç»„ä»¶ä¹‹é—´éœ€è¦é£æ ¼ä¸€è‡´ | æŠ½è±¡å·¥å‚æ¨¡å¼ |
| äº§å“ç§ç±»ç»å¸¸å˜åŠ¨ | å·¥å‚æ–¹æ³•æ¨¡å¼ |
| äº§å“ç§ç±»ç¨³å®šï¼Œéœ€è¦æ•´å¥—åˆ‡æ¢ | æŠ½è±¡å·¥å‚æ¨¡å¼ |

---

> **ä¸‹ä¸€ç« é¢„å‘Šï¼šã€Šå•ä¾‹æ¨¡å¼ã€‹â€”â€” å…¨å±€åªæœ‰ä¸€ä¸ª"è€å©†"çš„æ­£ç¡®æ‰“å¼€æ–¹å¼**
> 
> æˆ‘ä»¬å°†è®²è§£å¦‚ä½•ä¼˜é›…åœ°ç®¡ç†å…¨å±€çŠ¶æ€ã€å¼¹çª—ç®¡ç†å™¨ã€API å®¢æˆ·ç«¯ç­‰"å…¨å±€å”¯ä¸€"çš„åœºæ™¯ã€‚

---

*å¦‚æœ‰ç–‘é—®æˆ–å»ºè®®ï¼Œæ¬¢è¿äº¤æµï¼*

