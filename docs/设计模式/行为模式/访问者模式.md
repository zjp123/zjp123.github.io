# è®¿é—®è€…æ¨¡å¼ï¼ˆVisitor Patternï¼‰

> ã€Šå‰ç«¯è®¾è®¡æ¨¡å¼å®æˆ˜æ‰‹å†Œã€‹ç³»åˆ— - ç¬¬åç« 

---

## ä¸€å¥è¯å¤§ç™½è¯

**å°±åƒåŒ»é™¢ä½“æ£€**ï¼šä½ å»åŒ»é™¢ä½“æ£€ï¼Œè¦å»ä¸åŒçš„ç§‘å®¤ï¼ˆçœ¼ç§‘ã€ç‰™ç§‘ã€å†…ç§‘ï¼‰ã€‚æ¯ä¸ªç§‘å®¤ï¼ˆè®¿é—®è€…ï¼‰å¯¹ä½ ï¼ˆå…ƒç´ ï¼‰åšä¸åŒçš„æ£€æŸ¥ï¼Œä½†ä½ ä¸éœ€è¦çŸ¥é“ä»–ä»¬æ€ä¹ˆæ£€æŸ¥ï¼Œåªéœ€è¦é…åˆå°±è¡Œã€‚ç§‘å®¤å¯ä»¥éšæ„å¢åŠ æ–°çš„æ£€æŸ¥é¡¹ç›®ï¼Œä½†ä½“æ£€çš„äººï¼ˆå…ƒç´ ï¼‰ä¸éœ€è¦æ”¹å˜ã€‚

## å‰ç«¯ç—›ç‚¹

æƒ³è±¡ä¸€ä¸‹ï¼Œä½ åœ¨å¤„ç†ä¸€ä¸ªå¤æ‚çš„æ•°æ®ç»“æ„ï¼ˆå¦‚æ–‡æ¡£æ ‘ï¼‰ï¼Œéœ€è¦å¯¹ä¸åŒç±»å‹çš„èŠ‚ç‚¹æ‰§è¡Œä¸åŒçš„æ“ä½œï¼š

```typescript
// âŒ æ²¡æœ‰ä½¿ç”¨è®¿é—®è€…æ¨¡å¼çš„ä»£ç ï¼šæŠŠæ“ä½œé€»è¾‘å†™åœ¨å…ƒç´ ç±»é‡Œ
class TextNode {
  content: string;
  
  // æ¸²æŸ“
  render() {
    return `<p>${this.content}</p>`;
  }
  
  // å¯¼å‡ºä¸º Markdown
  toMarkdown() {
    return this.content;
  }
  
  // ç»Ÿè®¡å­—æ•°
  countWords() {
    return this.content.split(' ').length;
  }
  
  // æ¯å¢åŠ ä¸€ç§æ“ä½œï¼Œå°±è¦ä¿®æ”¹è¿™ä¸ªç±»ï¼
  // å¦‚æœæœ‰10ç§èŠ‚ç‚¹ç±»å‹ï¼Œæ¯ä¸ªç±»éƒ½è¦åŠ è¿™äº›æ–¹æ³•ï¼
}

class ImageNode {
  src: string;
  alt: string;
  
  render() {
    return `<img src="${this.src}" alt="${this.alt}" />`;
  }
  
  toMarkdown() {
    return `![${this.alt}](${this.src})`;
  }
  
  countWords() {
    return 0;
  }
  
  // åŒæ ·çš„é—®é¢˜ï¼šæ–°å¢æ“ä½œè¦æ”¹æ‰€æœ‰èŠ‚ç‚¹ç±»
}

// è¿˜æœ‰ HeadingNodeã€ListNodeã€CodeNode...
// æ¯ä¸ªç±»éƒ½è¦å®ç°æ‰€æœ‰æ“ä½œæ–¹æ³•ï¼Œä»£ç é‡å¤ä¸”éš¾ä»¥ç»´æŠ¤
```

**è¿™æ®µä»£ç çš„é—®é¢˜ï¼š**
1. ğŸ”— **æ“ä½œå’Œæ•°æ®è€¦åˆ**ï¼šæ“ä½œé€»è¾‘å†™åœ¨æ•°æ®ç±»é‡Œï¼ŒèŒè´£ä¸æ¸…
2. ğŸ”„ **éš¾ä»¥æ‰©å±•**ï¼šæ–°å¢æ“ä½œéœ€è¦ä¿®æ”¹æ‰€æœ‰å…ƒç´ ç±»
3. ğŸ§© **è¿åå¼€é—­åŸåˆ™**ï¼šå¯¹ä¿®æ”¹å¼€æ”¾ï¼Œå¯¹æ‰©å±•ä¸å‹å¥½
4. ğŸ“¦ **ä»£ç åˆ†æ•£**ï¼šç›¸å…³çš„æ“ä½œé€»è¾‘åˆ†æ•£åœ¨å„ä¸ªç±»ä¸­

## æ¨¡å¼æ ¸å¿ƒæ¦‚å¿µ

**è®¿é—®è€…æ¨¡å¼çš„æœ¬è´¨**ï¼šå°†æ“ä½œä¸æ•°æ®ç»“æ„åˆ†ç¦»ã€‚å…ƒç´ ç±»æä¾›ä¸€ä¸ªæ¥å—è®¿é—®è€…çš„æ¥å£ï¼Œè®¿é—®è€…ç±»å®ç°å¯¹ä¸åŒå…ƒç´ çš„æ“ä½œã€‚

**å››ä¸ªæ ¸å¿ƒè§’è‰²ï¼š**
- **è®¿é—®è€…ï¼ˆVisitorï¼‰**ï¼šå®šä¹‰è®¿é—®å„ç§å…ƒç´ çš„æ¥å£
- **å…·ä½“è®¿é—®è€…ï¼ˆConcreteVisitorï¼‰**ï¼šå®ç°å…·ä½“çš„æ“ä½œé€»è¾‘
- **å…ƒç´ ï¼ˆElementï¼‰**ï¼šå®šä¹‰æ¥å—è®¿é—®è€…çš„æ¥å£
- **å…·ä½“å…ƒç´ ï¼ˆConcreteElementï¼‰**ï¼šå®ç°æ¥å—è®¿é—®è€…çš„æ–¹æ³•ï¼Œè°ƒç”¨è®¿é—®è€…çš„ç›¸åº”æ–¹æ³•

**ç±»æ¯”**ï¼š
- ğŸ¥ **åŒ»é™¢ä½“æ£€**ï¼šæ‚£è€…ï¼ˆå…ƒç´ ï¼‰â†’ ä¸åŒç§‘å®¤ï¼ˆè®¿é—®è€…ï¼‰â†’ ä¸åŒæ£€æŸ¥
- ğŸ“¦ **å¿«é€’æ´¾é€**ï¼šåŒ…è£¹ï¼ˆå…ƒç´ ï¼‰â†’ ä¸åŒå¤„ç†ç«™ï¼ˆè®¿é—®è€…ï¼‰â†’ æ‰«æ/åˆ†æ‹£/æ´¾é€
- ğŸ¨ **åšç‰©é¦†å¯¼è§ˆ**ï¼šå±•å“ï¼ˆå…ƒç´ ï¼‰â†’ ä¸åŒå¯¼æ¸¸ï¼ˆè®¿é—®è€…ï¼‰â†’ ä¸åŒè®²è§£é£æ ¼

**æ ¸å¿ƒæ€æƒ³ï¼šåŒé‡åˆ†æ´¾ï¼ˆDouble Dispatchï¼‰**

```typescript
// å…ƒç´ æ¥å—è®¿é—®è€…
element.accept(visitor);

// åœ¨ accept æ–¹æ³•å†…éƒ¨ï¼Œå…ƒç´ å‘Šè¯‰è®¿é—®è€…è‡ªå·±çš„ç±»å‹
visitor.visitTextNode(this);  // åŒé‡åˆ†æ´¾

// è®¿é—®è€…æ ¹æ®å…ƒç´ ç±»å‹æ‰§è¡Œä¸åŒçš„æ“ä½œ
```

## å‰ç«¯å®æˆ˜æ¡ˆä¾‹

### åœºæ™¯ä¸€ï¼šæ–‡æ¡£ç»“æ„å¤„ç†ï¼ˆAST éå†ï¼‰

æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªç®€å•çš„æ–‡æ¡£ç¼–è¾‘å™¨ï¼Œæ”¯æŒå¤šç§æ“ä½œï¼ˆæ¸²æŸ“ã€å¯¼å‡ºã€ç»Ÿè®¡ï¼‰ï¼š

```typescript
// âœ… ä½¿ç”¨è®¿é—®è€…æ¨¡å¼é‡æ„

import React, { useState } from 'react';
import { Card, Button, Space, Tabs, Tag, Divider } from 'antd';
import { FileTextOutlined, ExportOutlined, BarChartOutlined } from '@ant-design/icons';

// 1ï¸âƒ£ è®¿é—®è€…æ¥å£
interface DocumentVisitor {
  visitTextNode(node: TextNode): any;
  visitHeadingNode(node: HeadingNode): any;
  visitImageNode(node: ImageNode): any;
  visitCodeNode(node: CodeNode): any;
  visitListNode(node: ListNode): any;
}

// 2ï¸âƒ£ å…ƒç´ æ¥å£
interface DocumentNode {
  accept(visitor: DocumentVisitor): any;
}

// 3ï¸âƒ£ å…·ä½“å…ƒç´ ï¼šæ–‡æœ¬èŠ‚ç‚¹
class TextNode implements DocumentNode {
  content: string;
  
  constructor(content: string) {
    this.content = content;
  }
  
  accept(visitor: DocumentVisitor): any {
    return visitor.visitTextNode(this);
  }
  
  getContent(): string {
    return this.content;
  }
}

// 4ï¸âƒ£ å…·ä½“å…ƒç´ ï¼šæ ‡é¢˜èŠ‚ç‚¹
class HeadingNode implements DocumentNode {
  level: number;
  text: string;
  
  constructor(level: number, text: string) {
    this.level = level;
    this.text = text;
  }
  
  accept(visitor: DocumentVisitor): any {
    return visitor.visitHeadingNode(this);
  }
  
  getLevel(): number {
    return this.level;
  }
  
  getText(): string {
    return this.text;
  }
}

// 5ï¸âƒ£ å…·ä½“å…ƒç´ ï¼šå›¾ç‰‡èŠ‚ç‚¹
class ImageNode implements DocumentNode {
  src: string;
  alt: string;
  
  constructor(src: string, alt: string) {
    this.src = src;
    this.alt = alt;
  }
  
  accept(visitor: DocumentVisitor): any {
    return visitor.visitImageNode(this);
  }
  
  getSrc(): string {
    return this.src;
  }
  
  getAlt(): string {
    return this.alt;
  }
}

// 6ï¸âƒ£ å…·ä½“å…ƒç´ ï¼šä»£ç èŠ‚ç‚¹
class CodeNode implements DocumentNode {
  language: string;
  code: string;
  
  constructor(language: string, code: string) {
    this.language = language;
    this.code = code;
  }
  
  accept(visitor: DocumentVisitor): any {
    return visitor.visitCodeNode(this);
  }
  
  getLanguage(): string {
    return this.language;
  }
  
  getCode(): string {
    return this.code;
  }
}

// 7ï¸âƒ£ å…·ä½“å…ƒç´ ï¼šåˆ—è¡¨èŠ‚ç‚¹
class ListNode implements DocumentNode {
  items: string[];
  ordered: boolean;
  
  constructor(items: string[], ordered: boolean = false) {
    this.items = items;
    this.ordered = ordered;
  }
  
  accept(visitor: DocumentVisitor): any {
    return visitor.visitListNode(this);
  }
  
  getItems(): string[] {
    return this.items;
  }
  
  isOrdered(): boolean {
    return this.ordered;
  }
}

// 8ï¸âƒ£ å…·ä½“è®¿é—®è€…ï¼šHTML æ¸²æŸ“å™¨
class HTMLRenderer implements DocumentVisitor {
  visitTextNode(node: TextNode): string {
    return `<p>${node.getContent()}</p>`;
  }
  
  visitHeadingNode(node: HeadingNode): string {
    const level = node.getLevel();
    const text = node.getText();
    return `<h${level}>${text}</h${level}>`;
  }
  
  visitImageNode(node: ImageNode): string {
    return `<img src="${node.getSrc()}" alt="${node.getAlt()}" style="max-width: 100%;" />`;
  }
  
  visitCodeNode(node: CodeNode): string {
    return `<pre><code class="language-${node.getLanguage()}">${node.getCode()}</code></pre>`;
  }
  
  visitListNode(node: ListNode): string {
    const tag = node.isOrdered() ? 'ol' : 'ul';
    const items = node.getItems()
      .map(item => `<li>${item}</li>`)
      .join('');
    return `<${tag}>${items}</${tag}>`;
  }
}

// 9ï¸âƒ£ å…·ä½“è®¿é—®è€…ï¼šMarkdown å¯¼å‡ºå™¨
class MarkdownExporter implements DocumentVisitor {
  visitTextNode(node: TextNode): string {
    return node.getContent();
  }
  
  visitHeadingNode(node: HeadingNode): string {
    const level = node.getLevel();
    const prefix = '#'.repeat(level);
    return `${prefix} ${node.getText()}`;
  }
  
  visitImageNode(node: ImageNode): string {
    return `![${node.getAlt()}](${node.getSrc()})`;
  }
  
  visitCodeNode(node: CodeNode): string {
    return `\`\`\`${node.getLanguage()}\n${node.getCode()}\n\`\`\``;
  }
  
  visitListNode(node: ListNode): string {
    const prefix = node.isOrdered() ? (i: number) => `${i + 1}. ` : () => '- ';
    return node.getItems()
      .map((item, index) => `${prefix(index)}${item}`)
      .join('\n');
  }
}

// ğŸ”Ÿ å…·ä½“è®¿é—®è€…ï¼šç»Ÿè®¡åˆ†æå™¨
class StatisticsAnalyzer implements DocumentVisitor {
  private stats = {
    textNodes: 0,
    headings: 0,
    images: 0,
    codeBlocks: 0,
    lists: 0,
    totalWords: 0,
    totalCharacters: 0,
  };
  
  visitTextNode(node: TextNode): void {
    this.stats.textNodes++;
    const content = node.getContent();
    this.stats.totalWords += content.split(/\s+/).filter(w => w.length > 0).length;
    this.stats.totalCharacters += content.length;
  }
  
  visitHeadingNode(node: HeadingNode): void {
    this.stats.headings++;
    const text = node.getText();
    this.stats.totalWords += text.split(/\s+/).filter(w => w.length > 0).length;
    this.stats.totalCharacters += text.length;
  }
  
  visitImageNode(node: ImageNode): void {
    this.stats.images++;
  }
  
  visitCodeNode(node: CodeNode): void {
    this.stats.codeBlocks++;
    this.stats.totalCharacters += node.getCode().length;
  }
  
  visitListNode(node: ListNode): void {
    this.stats.lists++;
    const allItems = node.getItems().join(' ');
    this.stats.totalWords += allItems.split(/\s+/).filter(w => w.length > 0).length;
    this.stats.totalCharacters += allItems.length;
  }
  
  getStatistics() {
    return { ...this.stats };
  }
  
  reset(): void {
    this.stats = {
      textNodes: 0,
      headings: 0,
      images: 0,
      codeBlocks: 0,
      lists: 0,
      totalWords: 0,
      totalCharacters: 0,
    };
  }
}

// æ–‡æ¡£ç±»ï¼šç®¡ç†æ‰€æœ‰èŠ‚ç‚¹
class Document {
  private nodes: DocumentNode[] = [];
  
  addNode(node: DocumentNode): void {
    this.nodes.push(node);
  }
  
  getNodes(): DocumentNode[] {
    return this.nodes;
  }
  
  // æ¥å—è®¿é—®è€…éå†æ‰€æœ‰èŠ‚ç‚¹
  accept(visitor: DocumentVisitor): any[] {
    return this.nodes.map(node => node.accept(visitor));
  }
}

// React ç»„ä»¶
const VisitorPatternDemo: React.FC = () => {
  // åˆ›å»ºç¤ºä¾‹æ–‡æ¡£
  const [document] = useState(() => {
    const doc = new Document();
    doc.addNode(new HeadingNode(1, 'è®¿é—®è€…æ¨¡å¼ç¤ºä¾‹æ–‡æ¡£'));
    doc.addNode(new TextNode('è¿™æ˜¯ä¸€æ®µç¤ºä¾‹æ–‡æœ¬ï¼Œç”¨äºæ¼”ç¤ºè®¿é—®è€…æ¨¡å¼çš„å·¥ä½œåŸç†ã€‚'));
    doc.addNode(new HeadingNode(2, 'ä»£ç ç¤ºä¾‹'));
    doc.addNode(new CodeNode('javascript', 'const greeting = "Hello, World!";\nconsole.log(greeting);'));
    doc.addNode(new HeadingNode(2, 'åˆ—è¡¨ç¤ºä¾‹'));
    doc.addNode(new ListNode(['è®¿é—®è€…æ¨¡å¼', 'ç­–ç•¥æ¨¡å¼', 'è§‚å¯Ÿè€…æ¨¡å¼'], true));
    doc.addNode(new ImageNode('https://via.placeholder.com/400x200', 'ç¤ºä¾‹å›¾ç‰‡'));
    doc.addNode(new TextNode('è®¿é—®è€…æ¨¡å¼å°†æ“ä½œä¸æ•°æ®ç»“æ„åˆ†ç¦»ï¼Œä½¿å¾—å¯ä»¥åœ¨ä¸ä¿®æ”¹å…ƒç´ ç±»çš„æƒ…å†µä¸‹å®šä¹‰æ–°çš„æ“ä½œã€‚'));
    return doc;
  });
  
  const [htmlOutput, setHtmlOutput] = useState('');
  const [markdownOutput, setMarkdownOutput] = useState('');
  const [statistics, setStatistics] = useState<any>(null);
  
  // æ¸²æŸ“ HTML
  const handleRenderHTML = () => {
    const renderer = new HTMLRenderer();
    const results = document.accept(renderer);
    const html = results.join('\n');
    setHtmlOutput(html);
  };
  
  // å¯¼å‡º Markdown
  const handleExportMarkdown = () => {
    const exporter = new MarkdownExporter();
    const results = document.accept(exporter);
    const markdown = results.join('\n\n');
    setMarkdownOutput(markdown);
  };
  
  // ç»Ÿè®¡åˆ†æ
  const handleAnalyze = () => {
    const analyzer = new StatisticsAnalyzer();
    document.accept(analyzer);
    setStatistics(analyzer.getStatistics());
  };
  
  React.useEffect(() => {
    handleRenderHTML();
    handleExportMarkdown();
    handleAnalyze();
  }, []);
  
  return (
    <div style={{ padding: 24, backgroundColor: '#f0f2f5', minHeight: '100vh' }}>
      <Card title="ğŸ“„ æ–‡æ¡£å¤„ç†ï¼ˆè®¿é—®è€…æ¨¡å¼ï¼‰" style={{ maxWidth: 1200, margin: '0 auto' }}>
        {/* æ“ä½œæŒ‰é’® */}
        <Card type="inner" style={{ marginBottom: 16 }}>
          <Space>
            <Button
              type="primary"
              icon={<FileTextOutlined />}
              onClick={handleRenderHTML}
            >
              æ¸²æŸ“ HTML
            </Button>
            <Button
              icon={<ExportOutlined />}
              onClick={handleExportMarkdown}
            >
              å¯¼å‡º Markdown
            </Button>
            <Button
              icon={<BarChartOutlined />}
              onClick={handleAnalyze}
            >
              ç»Ÿè®¡åˆ†æ
            </Button>
          </Space>
          <div style={{ marginTop: 12, fontSize: 12, color: '#666' }}>
            ğŸ’¡ åŒä¸€ä¸ªæ–‡æ¡£ç»“æ„ï¼Œä¸åŒçš„è®¿é—®è€…æ‰§è¡Œä¸åŒçš„æ“ä½œ
          </div>
        </Card>
        
        {/* æ–‡æ¡£èŠ‚ç‚¹åˆ—è¡¨ */}
        <Card type="inner" title="æ–‡æ¡£èŠ‚ç‚¹" style={{ marginBottom: 16 }}>
          <Space wrap>
            {document.getNodes().map((node, index) => {
              let label = '';
              let color = 'blue';
              
              if (node instanceof TextNode) {
                label = 'æ–‡æœ¬';
                color = 'blue';
              } else if (node instanceof HeadingNode) {
                label = `æ ‡é¢˜ H${(node as HeadingNode).getLevel()}`;
                color = 'purple';
              } else if (node instanceof ImageNode) {
                label = 'å›¾ç‰‡';
                color = 'green';
              } else if (node instanceof CodeNode) {
                label = 'ä»£ç ';
                color = 'orange';
              } else if (node instanceof ListNode) {
                label = 'åˆ—è¡¨';
                color = 'cyan';
              }
              
              return <Tag key={index} color={color}>{index + 1}. {label}</Tag>;
            })}
          </Space>
        </Card>
        
        {/* è¾“å‡ºç»“æœ */}
        <Tabs
          items={[
            {
              key: 'html',
              label: 'HTML é¢„è§ˆ',
              children: (
                <div>
                  <div
                    dangerouslySetInnerHTML={{ __html: htmlOutput }}
                    style={{
                      padding: 16,
                      backgroundColor: '#fff',
                      border: '1px solid #d9d9d9',
                      borderRadius: 4,
                      minHeight: 300,
                    }}
                  />
                </div>
              ),
            },
            {
              key: 'markdown',
              label: 'Markdown æºç ',
              children: (
                <pre style={{
                  padding: 16,
                  backgroundColor: '#f5f5f5',
                  border: '1px solid #d9d9d9',
                  borderRadius: 4,
                  minHeight: 300,
                  overflow: 'auto',
                }}>
                  {markdownOutput}
                </pre>
              ),
            },
            {
              key: 'stats',
              label: 'ç»Ÿè®¡ä¿¡æ¯',
              children: statistics && (
                <div style={{
                  padding: 16,
                  backgroundColor: '#fafafa',
                  border: '1px solid #d9d9d9',
                  borderRadius: 4,
                }}>
                  <Space direction="vertical" style={{ width: '100%' }}>
                    <div>ğŸ“ æ–‡æœ¬èŠ‚ç‚¹: {statistics.textNodes} ä¸ª</div>
                    <div>ğŸ“° æ ‡é¢˜: {statistics.headings} ä¸ª</div>
                    <div>ğŸ–¼ï¸ å›¾ç‰‡: {statistics.images} ä¸ª</div>
                    <div>ğŸ’» ä»£ç å—: {statistics.codeBlocks} ä¸ª</div>
                    <div>ğŸ“‹ åˆ—è¡¨: {statistics.lists} ä¸ª</div>
                    <Divider />
                    <div><strong>ğŸ“Š æ€»å­—æ•°: {statistics.totalWords} ä¸ª</strong></div>
                    <div><strong>ğŸ”¤ æ€»å­—ç¬¦æ•°: {statistics.totalCharacters} ä¸ª</strong></div>
                  </Space>
                </div>
              ),
            },
          ]}
        />
        
        {/* è¯´æ˜ */}
        <Card type="inner" title="ğŸ“‹ è®¿é—®è€…æ¨¡å¼è¯´æ˜" style={{ marginTop: 16 }}>
          <ul style={{ margin: 0, paddingLeft: 20 }}>
            <li>âœ… <strong>DocumentNode</strong> æ˜¯å…ƒç´ æ¥å£ï¼Œå®šä¹‰ accept æ–¹æ³•</li>
            <li>âœ… <strong>TextNodeã€HeadingNode ç­‰</strong> æ˜¯å…·ä½“å…ƒç´ </li>
            <li>âœ… <strong>DocumentVisitor</strong> æ˜¯è®¿é—®è€…æ¥å£</li>
            <li>âœ… <strong>HTMLRendererã€MarkdownExporterã€StatisticsAnalyzer</strong> æ˜¯å…·ä½“è®¿é—®è€…</li>
            <li>âœ… æ–°å¢æ“ä½œï¼ˆå¦‚ PDF å¯¼å‡ºï¼‰åªéœ€æ·»åŠ æ–°çš„è®¿é—®è€…ï¼Œæ— éœ€ä¿®æ”¹å…ƒç´ ç±»</li>
            <li>âœ… æ¯ä¸ªè®¿é—®è€…ç‹¬ç«‹å®ç°å¯¹æ‰€æœ‰å…ƒç´ ç±»å‹çš„æ“ä½œ</li>
          </ul>
        </Card>
      </Card>
    </div>
  );
};

export default VisitorPatternDemo;
```

#### ğŸ¯ ä½¿ç”¨è®¿é—®è€…æ¨¡å¼åçš„å¥½å¤„

1. **æ“ä½œé›†ä¸­**ï¼šåŒä¸€æ“ä½œçš„é€»è¾‘é›†ä¸­åœ¨ä¸€ä¸ªè®¿é—®è€…ç±»ä¸­
2. **æ˜“äºæ‰©å±•**ï¼šæ–°å¢æ“ä½œåªéœ€æ·»åŠ æ–°è®¿é—®è€…ï¼Œä¸ä¿®æ”¹å…ƒç´ ç±»
3. **èŒè´£åˆ†ç¦»**ï¼šæ•°æ®ç»“æ„å’Œæ“ä½œé€»è¾‘åˆ†ç¦»
4. **ç¬¦åˆå¼€é—­åŸåˆ™**ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼ˆæ–°å¢è®¿é—®è€…ï¼‰ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼ˆå…ƒç´ ç±»ä¸å˜ï¼‰

---

### åœºæ™¯äºŒï¼šè¡¨å•å­—æ®µéªŒè¯ï¼ˆä¸åŒç±»å‹å­—æ®µçš„éªŒè¯ï¼‰

å®ç°ä¸€ä¸ªçµæ´»çš„è¡¨å•éªŒè¯ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§éªŒè¯ç­–ç•¥ï¼š

```typescript
import React, { useState } from 'react';
import { Card, Form, Input, InputNumber, DatePicker, Switch, Button, Alert, Space, Tag } from 'antd';
import { CheckCircleOutlined, CloseCircleOutlined } from '@ant-design/icons';

// è¡¨å•å­—æ®µæ¥å£
interface FormField {
  name: string;
  accept(visitor: FieldVisitor): any;
}

// è®¿é—®è€…æ¥å£
interface FieldVisitor {
  visitTextField(field: TextField): any;
  visitNumberField(field: NumberField): any;
  visitEmailField(field: EmailField): any;
  visitDateField(field: DateField): any;
  visitBooleanField(field: BooleanField): any;
}

// å…·ä½“å…ƒç´ ï¼šæ–‡æœ¬å­—æ®µ
class TextField implements FormField {
  name: string;
  value: string;
  required: boolean;
  minLength?: number;
  maxLength?: number;
  
  constructor(name: string, value: string, required: boolean = false, minLength?: number, maxLength?: number) {
    this.name = name;
    this.value = value;
    this.required = required;
    this.minLength = minLength;
    this.maxLength = maxLength;
  }
  
  accept(visitor: FieldVisitor): any {
    return visitor.visitTextField(this);
  }
}

// å…·ä½“å…ƒç´ ï¼šæ•°å­—å­—æ®µ
class NumberField implements FormField {
  name: string;
  value: number;
  required: boolean;
  min?: number;
  max?: number;
  
  constructor(name: string, value: number, required: boolean = false, min?: number, max?: number) {
    this.name = name;
    this.value = value;
    this.required = required;
    this.min = min;
    this.max = max;
  }
  
  accept(visitor: FieldVisitor): any {
    return visitor.visitNumberField(this);
  }
}

// å…·ä½“å…ƒç´ ï¼šé‚®ç®±å­—æ®µ
class EmailField implements FormField {
  name: string;
  value: string;
  required: boolean;
  
  constructor(name: string, value: string, required: boolean = false) {
    this.name = name;
    this.value = value;
    this.required = required;
  }
  
  accept(visitor: FieldVisitor): any {
    return visitor.visitEmailField(this);
  }
}

// å…·ä½“å…ƒç´ ï¼šæ—¥æœŸå­—æ®µ
class DateField implements FormField {
  name: string;
  value: string;
  required: boolean;
  
  constructor(name: string, value: string, required: boolean = false) {
    this.name = name;
    this.value = value;
    this.required = required;
  }
  
  accept(visitor: FieldVisitor): any {
    return visitor.visitDateField(this);
  }
}

// å…·ä½“å…ƒç´ ï¼šå¸ƒå°”å­—æ®µ
class BooleanField implements FormField {
  name: string;
  value: boolean;
  required: boolean;
  
  constructor(name: string, value: boolean, required: boolean = false) {
    this.name = name;
    this.value = value;
    this.required = required;
  }
  
  accept(visitor: FieldVisitor): any {
    return visitor.visitBooleanField(this);
  }
}

// éªŒè¯ç»“æœ
interface ValidationResult {
  valid: boolean;
  errors: string[];
}

// å…·ä½“è®¿é—®è€…ï¼šéªŒè¯å™¨
class FieldValidator implements FieldVisitor {
  visitTextField(field: TextField): ValidationResult {
    const errors: string[] = [];
    
    if (field.required && !field.value) {
      errors.push(`${field.name} ä¸èƒ½ä¸ºç©º`);
    }
    
    if (field.minLength && field.value.length < field.minLength) {
      errors.push(`${field.name} è‡³å°‘ ${field.minLength} ä¸ªå­—ç¬¦`);
    }
    
    if (field.maxLength && field.value.length > field.maxLength) {
      errors.push(`${field.name} æœ€å¤š ${field.maxLength} ä¸ªå­—ç¬¦`);
    }
    
    return { valid: errors.length === 0, errors };
  }
  
  visitNumberField(field: NumberField): ValidationResult {
    const errors: string[] = [];
    
    if (field.required && (field.value === null || field.value === undefined)) {
      errors.push(`${field.name} ä¸èƒ½ä¸ºç©º`);
    }
    
    if (field.min !== undefined && field.value < field.min) {
      errors.push(`${field.name} ä¸èƒ½å°äº ${field.min}`);
    }
    
    if (field.max !== undefined && field.value > field.max) {
      errors.push(`${field.name} ä¸èƒ½å¤§äº ${field.max}`);
    }
    
    return { valid: errors.length === 0, errors };
  }
  
  visitEmailField(field: EmailField): ValidationResult {
    const errors: string[] = [];
    
    if (field.required && !field.value) {
      errors.push(`${field.name} ä¸èƒ½ä¸ºç©º`);
    }
    
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (field.value && !emailRegex.test(field.value)) {
      errors.push(`${field.name} æ ¼å¼ä¸æ­£ç¡®`);
    }
    
    return { valid: errors.length === 0, errors };
  }
  
  visitDateField(field: DateField): ValidationResult {
    const errors: string[] = [];
    
    if (field.required && !field.value) {
      errors.push(`${field.name} ä¸èƒ½ä¸ºç©º`);
    }
    
    return { valid: errors.length === 0, errors };
  }
  
  visitBooleanField(field: BooleanField): ValidationResult {
    const errors: string[] = [];
    
    if (field.required && !field.value) {
      errors.push(`${field.name} å¿…é¡»å‹¾é€‰`);
    }
    
    return { valid: errors.length === 0, errors };
  }
}

// å…·ä½“è®¿é—®è€…ï¼šåºåˆ—åŒ–å™¨
class FieldSerializer implements FieldVisitor {
  visitTextField(field: TextField): any {
    return { type: 'text', name: field.name, value: field.value };
  }
  
  visitNumberField(field: NumberField): any {
    return { type: 'number', name: field.name, value: field.value };
  }
  
  visitEmailField(field: EmailField): any {
    return { type: 'email', name: field.name, value: field.value };
  }
  
  visitDateField(field: DateField): any {
    return { type: 'date', name: field.name, value: field.value };
  }
  
  visitBooleanField(field: BooleanField): any {
    return { type: 'boolean', name: field.name, value: field.value };
  }
}

// React ç»„ä»¶
const FormValidatorDemo: React.FC = () => {
  const [formData, setFormData] = useState({
    username: '',
    age: 18,
    email: '',
    birthday: '',
    agree: false,
  });
  
  const [validationResults, setValidationResults] = useState<Record<string, ValidationResult>>({});
  
  // åˆ›å»ºè¡¨å•å­—æ®µ
  const createFields = (): FormField[] => {
    return [
      new TextField('ç”¨æˆ·å', formData.username, true, 3, 20),
      new NumberField('å¹´é¾„', formData.age, true, 18, 100),
      new EmailField('é‚®ç®±', formData.email, true),
      new DateField('ç”Ÿæ—¥', formData.birthday, true),
      new BooleanField('åŒæ„åè®®', formData.agree, true),
    ];
  };
  
  // éªŒè¯è¡¨å•
  const handleValidate = () => {
    const fields = createFields();
    const validator = new FieldValidator();
    const results: Record<string, ValidationResult> = {};
    
    fields.forEach(field => {
      const result = field.accept(validator);
      results[field.name] = result;
    });
    
    setValidationResults(results);
  };
  
  // åºåˆ—åŒ–è¡¨å•
  const handleSerialize = () => {
    const fields = createFields();
    const serializer = new FieldSerializer();
    const serialized = fields.map(field => field.accept(serializer));
    
    console.log('åºåˆ—åŒ–ç»“æœ:', serialized);
    alert('åºåˆ—åŒ–ç»“æœå·²è¾“å‡ºåˆ°æ§åˆ¶å°');
  };
  
  return (
    <div style={{ padding: 24, backgroundColor: '#f0f2f5', minHeight: '100vh' }}>
      <Card title="ğŸ“ è¡¨å•éªŒè¯ï¼ˆè®¿é—®è€…æ¨¡å¼ï¼‰" style={{ maxWidth: 800, margin: '0 auto' }}>
        {/* è¡¨å• */}
        <Form layout="vertical">
          <Form.Item label="ç”¨æˆ·å" required>
            <Input
              value={formData.username}
              onChange={(e) => setFormData({ ...formData, username: e.target.value })}
              placeholder="3-20ä¸ªå­—ç¬¦"
            />
            {validationResults['ç”¨æˆ·å'] && !validationResults['ç”¨æˆ·å'].valid && (
              <Alert
                type="error"
                message={validationResults['ç”¨æˆ·å'].errors.join(', ')}
                style={{ marginTop: 8 }}
              />
            )}
          </Form.Item>
          
          <Form.Item label="å¹´é¾„" required>
            <InputNumber
              value={formData.age}
              onChange={(val) => setFormData({ ...formData, age: val || 0 })}
              min={0}
              style={{ width: '100%' }}
            />
            {validationResults['å¹´é¾„'] && !validationResults['å¹´é¾„'].valid && (
              <Alert
                type="error"
                message={validationResults['å¹´é¾„'].errors.join(', ')}
                style={{ marginTop: 8 }}
              />
            )}
          </Form.Item>
          
          <Form.Item label="é‚®ç®±" required>
            <Input
              value={formData.email}
              onChange={(e) => setFormData({ ...formData, email: e.target.value })}
              placeholder="example@domain.com"
            />
            {validationResults['é‚®ç®±'] && !validationResults['é‚®ç®±'].valid && (
              <Alert
                type="error"
                message={validationResults['é‚®ç®±'].errors.join(', ')}
                style={{ marginTop: 8 }}
              />
            )}
          </Form.Item>
          
          <Form.Item label="ç”Ÿæ—¥" required>
            <DatePicker
              style={{ width: '100%' }}
              onChange={(_, dateString) => setFormData({ ...formData, birthday: dateString as string })}
            />
            {validationResults['ç”Ÿæ—¥'] && !validationResults['ç”Ÿæ—¥'].valid && (
              <Alert
                type="error"
                message={validationResults['ç”Ÿæ—¥'].errors.join(', ')}
                style={{ marginTop: 8 }}
              />
            )}
          </Form.Item>
          
          <Form.Item>
            <Space>
              <Switch
                checked={formData.agree}
                onChange={(checked) => setFormData({ ...formData, agree: checked })}
              />
              <span>æˆ‘åŒæ„æœåŠ¡æ¡æ¬¾</span>
            </Space>
            {validationResults['åŒæ„åè®®'] && !validationResults['åŒæ„åè®®'].valid && (
              <Alert
                type="error"
                message={validationResults['åŒæ„åè®®'].errors.join(', ')}
                style={{ marginTop: 8 }}
              />
            )}
          </Form.Item>
          
          <Form.Item>
            <Space>
              <Button type="primary" onClick={handleValidate}>
                éªŒè¯è¡¨å•
              </Button>
              <Button onClick={handleSerialize}>
                åºåˆ—åŒ–è¡¨å•
              </Button>
            </Space>
          </Form.Item>
        </Form>
        
        {/* éªŒè¯ç»“æœæ±‡æ€» */}
        {Object.keys(validationResults).length > 0 && (
          <Card type="inner" title="éªŒè¯ç»“æœ" style={{ marginTop: 16 }}>
            {Object.entries(validationResults).map(([fieldName, result]) => (
              <div key={fieldName} style={{ marginBottom: 8 }}>
                {result.valid ? (
                  <Tag color="success" icon={<CheckCircleOutlined />}>
                    {fieldName}: é€šè¿‡
                  </Tag>
                ) : (
                  <Tag color="error" icon={<CloseCircleOutlined />}>
                    {fieldName}: {result.errors.join(', ')}
                  </Tag>
                )}
              </div>
            ))}
          </Card>
        )}
        
        {/* è¯´æ˜ */}
        <Card type="inner" title="ğŸ“‹ è®¿é—®è€…æ¨¡å¼è¯´æ˜" style={{ marginTop: 16 }}>
          <ul style={{ margin: 0, paddingLeft: 20 }}>
            <li>âœ… <strong>TextFieldã€NumberField ç­‰</strong> æ˜¯å…·ä½“å…ƒç´ </li>
            <li>âœ… <strong>FieldValidator</strong> æ˜¯éªŒè¯è®¿é—®è€…ï¼Œå®ç°éªŒè¯é€»è¾‘</li>
            <li>âœ… <strong>FieldSerializer</strong> æ˜¯åºåˆ—åŒ–è®¿é—®è€…ï¼Œå®ç°åºåˆ—åŒ–é€»è¾‘</li>
            <li>âœ… æ–°å¢æ“ä½œï¼ˆå¦‚å¯¼å‡º JSON Schemaï¼‰åªéœ€æ·»åŠ æ–°è®¿é—®è€…</li>
            <li>âœ… æ¯ä¸ªè®¿é—®è€…å¯¹ä¸åŒç±»å‹çš„å­—æ®µæœ‰ä¸åŒçš„å¤„ç†æ–¹å¼</li>
          </ul>
        </Card>
      </Card>
    </div>
  );
};

export default FormValidatorDemo;
```

## æ¨¡å¼æ€»ç»“

### âœ… ä¼˜ç‚¹

1. **ç¬¦åˆå¼€é—­åŸåˆ™**ï¼šæ–°å¢æ“ä½œåªéœ€æ·»åŠ è®¿é—®è€…ï¼Œä¸ä¿®æ”¹å…ƒç´ ç±»
2. **æ“ä½œé›†ä¸­**ï¼šç›¸å…³æ“ä½œé›†ä¸­åœ¨ä¸€ä¸ªè®¿é—®è€…ç±»ä¸­ï¼Œæ˜“äºç»´æŠ¤
3. **èŒè´£åˆ†ç¦»**ï¼šæ•°æ®ç»“æ„å’Œæ“ä½œé€»è¾‘åˆ†ç¦»
4. **æ˜“äºæ·»åŠ æ–°æ“ä½œ**ï¼šæ·»åŠ æ–°è®¿é—®è€…å¾ˆå®¹æ˜“
5. **ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™**ï¼šæ¯ä¸ªè®¿é—®è€…åªè´Ÿè´£ä¸€ç§æ“ä½œ

### âŒ ç¼ºç‚¹

1. **å¢åŠ å…ƒç´ ç±»å›°éš¾**ï¼šæ–°å¢å…ƒç´ ç±»å‹éœ€è¦ä¿®æ”¹æ‰€æœ‰è®¿é—®è€…
2. **ç ´åå°è£…**ï¼šè®¿é—®è€…éœ€è¦è®¿é—®å…ƒç´ çš„å†…éƒ¨æ•°æ®
3. **å¢åŠ å¤æ‚åº¦**ï¼šå¼•å…¥åŒé‡åˆ†æ´¾ï¼Œç†è§£æˆæœ¬è¾ƒé«˜
4. **è®¿é—®è€…æ¥å£å˜åŒ–é¢‘ç¹**ï¼šå…ƒç´ ç±»å‹å˜åŒ–æ—¶ï¼Œè®¿é—®è€…æ¥å£ä¹Ÿè¦å˜

### ğŸ¯ é€‚ç”¨åœºæ™¯

è®¿é—®è€…æ¨¡å¼ç‰¹åˆ«é€‚åˆä»¥ä¸‹å‰ç«¯åœºæ™¯ï¼š

| åœºæ™¯ | è¯´æ˜ | å…¸å‹æ“ä½œ |
|------|------|---------|
| **AST å¤„ç†** | æŠ½è±¡è¯­æ³•æ ‘éå†å’Œè½¬æ¢ | Babelã€TypeScript ç¼–è¯‘å™¨ |
| **æ–‡æ¡£å¤„ç†** | ä¸åŒç±»å‹èŠ‚ç‚¹çš„æ“ä½œ | æ¸²æŸ“ã€å¯¼å‡ºã€ç»Ÿè®¡ |
| **è¡¨å•éªŒè¯** | ä¸åŒç±»å‹å­—æ®µçš„éªŒè¯ | éªŒè¯ã€åºåˆ—åŒ–ã€é‡ç½® |
| **æŠ¥è¡¨ç”Ÿæˆ** | ä¸åŒæ•°æ®ç±»å‹çš„æ¸²æŸ“ | HTMLã€PDFã€Excel |
| **é…ç½®è§£æ** | ä¸åŒé…ç½®é¡¹çš„å¤„ç† | éªŒè¯ã€è½¬æ¢ã€åˆå¹¶ |
| **ç»„ä»¶æ ‘éå†** | React/Vue ç»„ä»¶æ ‘æ“ä½œ | æŸ¥æ‰¾ã€ç»Ÿè®¡ã€è½¬æ¢ |
| **å›¾å½¢ç¼–è¾‘å™¨** | ä¸åŒå›¾å½¢å…ƒç´ çš„æ“ä½œ | ç»˜åˆ¶ã€å¯¼å‡ºã€è®¡ç®— |

### ğŸ¤” ä»€ä¹ˆæ—¶å€™è¯¥ç”¨è®¿é—®è€…æ¨¡å¼ï¼Ÿ

**ä¸‰ä¸ªåˆ¤æ–­æ ‡å‡†ï¼š**

1. **æœ‰ç¨³å®šçš„æ•°æ®ç»“æ„å—ï¼Ÿ**
   - å…ƒç´ ç±»å‹ä¸ç»å¸¸å˜åŒ–

2. **éœ€è¦å¯¹æ•°æ®æ‰§è¡Œå¤šç§æ“ä½œå—ï¼Ÿ**
   - æ¸²æŸ“ã€å¯¼å‡ºã€éªŒè¯ã€ç»Ÿè®¡ç­‰

3. **æ“ä½œé€»è¾‘ç»å¸¸å˜åŒ–æˆ–æ–°å¢å—ï¼Ÿ**
   - éœ€è¦é¢‘ç¹æ·»åŠ æ–°æ“ä½œ

**å¿«é€Ÿå†³ç­–æ ‘ï¼š**

```
æœ‰ç¨³å®šçš„æ•°æ®ç»“æ„å—ï¼Ÿ
    â”œâ”€ æ˜¯ â†’ éœ€è¦å¯¹æ•°æ®æ‰§è¡Œå¤šç§æ“ä½œå—ï¼Ÿ
    â”‚        â”œâ”€ æ˜¯ â†’ æ“ä½œé€»è¾‘ç»å¸¸å˜åŒ–å—ï¼Ÿ
    â”‚        â”‚        â”œâ”€ æ˜¯ â†’ âœ… ç”¨è®¿é—®è€…æ¨¡å¼ï¼
    â”‚        â”‚        â””â”€ å¦ â†’ ğŸ¤” ç›´æ¥åœ¨å…ƒç´ ç±»ä¸­å®ç°ä¹Ÿè¡Œ
    â”‚        â””â”€ å¦ â†’ âŒ ä¸éœ€è¦
    â””â”€ å¦ â†’ âŒ ä¸é€‚åˆï¼ˆå…ƒç´ ç±»å‹é¢‘ç¹å˜åŒ–ï¼‰
```

### ğŸ†š è®¿é—®è€…æ¨¡å¼ vs ç­–ç•¥æ¨¡å¼

| ç‰¹å¾ | è®¿é—®è€…æ¨¡å¼ | ç­–ç•¥æ¨¡å¼ |
|------|-----------|---------|
| **ç›®çš„** | å¯¹æ•°æ®ç»“æ„æ‰§è¡Œå¤šç§æ“ä½œ | å°è£…å¯äº’æ¢çš„ç®—æ³• |
| **å…³æ³¨ç‚¹** | æ“ä½œä¸æ•°æ®åˆ†ç¦» | ç®—æ³•çš„ä¸åŒå®ç° |
| **åŒé‡åˆ†æ´¾** | æ˜¯ | å¦ |
| **æ‰©å±•æ–¹å‘** | æ˜“äºæ·»åŠ æ“ä½œï¼Œéš¾äºæ·»åŠ å…ƒç´  | æ˜“äºæ·»åŠ ç­–ç•¥ |
| **å…¸å‹åœºæ™¯** | AST éå†ã€æ–‡æ¡£å¤„ç† | æ”¯ä»˜æ–¹å¼ã€æ’åºç®—æ³• |

### ğŸ’¡ å‰ç«¯å®é™…åº”ç”¨

#### 1. Babel æ’ä»¶ï¼ˆAST è®¿é—®è€…ï¼‰

```typescript
// Babel ä½¿ç”¨è®¿é—®è€…æ¨¡å¼éå† AST
module.exports = function() {
  return {
    visitor: {
      // è®¿é—®æ ‡è¯†ç¬¦èŠ‚ç‚¹
      Identifier(path) {
        if (path.node.name === 'foo') {
          path.node.name = 'bar';
        }
      },
      
      // è®¿é—®å‡½æ•°å£°æ˜èŠ‚ç‚¹
      FunctionDeclaration(path) {
        // å¤„ç†å‡½æ•°å£°æ˜
      }
    }
  };
};
```

#### 2. DOM éå†

```typescript
// è®¿é—®è€…éå† DOM æ ‘
interface DOMVisitor {
  visitElement(element: Element): void;
  visitText(text: Text): void;
  visitComment(comment: Comment): void;
}

function traverseDOM(node: Node, visitor: DOMVisitor) {
  if (node.nodeType === Node.ELEMENT_NODE) {
    visitor.visitElement(node as Element);
  } else if (node.nodeType === Node.TEXT_NODE) {
    visitor.visitText(node as Text);
  } else if (node.nodeType === Node.COMMENT_NODE) {
    visitor.visitComment(node as Comment);
  }
  
  node.childNodes.forEach(child => traverseDOM(child, visitor));
}
```

### ğŸ”§ å®ç°æŠ€å·§

#### 1. ä½¿ç”¨ TypeScript ç±»å‹ä¿æŠ¤

```typescript
interface Visitor {
  visit(element: Element): void;
}

class Element {
  accept(visitor: Visitor) {
    visitor.visit(this);
  }
}

// åœ¨è®¿é—®è€…ä¸­ä½¿ç”¨ç±»å‹ä¿æŠ¤
class MyVisitor implements Visitor {
  visit(element: Element) {
    if (element instanceof TextElement) {
      // TypeScript è‡ªåŠ¨æ¨æ–­ç±»å‹
      console.log(element.text);
    }
  }
}
```

#### 2. ç®€åŒ–çš„è®¿é—®è€…ï¼ˆä½¿ç”¨å‡½æ•°ï¼‰

```typescript
// ä¸ç”¨å®Œæ•´çš„ç±»ï¼Œä½¿ç”¨å‡½æ•°å¯¹è±¡
const visitors = {
  text: (node: TextNode) => { /* ... */ },
  heading: (node: HeadingNode) => { /* ... */ },
  image: (node: ImageNode) => { /* ... */ },
};

// è®¿é—®æ—¶ç›´æ¥è°ƒç”¨
node.accept(visitors);
```

---

## ğŸ’¬ å°ç»“

è®¿é—®è€…æ¨¡å¼å°±åƒ"ä¸“å®¶ä¼šè¯Š"ï¼Œä¸åŒçš„ä¸“å®¶ï¼ˆè®¿é—®è€…ï¼‰å¯¹åŒä¸€ä¸ªç—…äººï¼ˆå…ƒç´ ï¼‰åšä¸åŒçš„æ£€æŸ¥ã€‚ç—…äººä¸éœ€è¦çŸ¥é“ä¸“å®¶æ€ä¹ˆæ£€æŸ¥ï¼Œä¸“å®¶ä¹Ÿå¯ä»¥éšæ—¶æ›´æ¢ï¼Œä½†ç—…äººæœ¬èº«ä¸å˜ã€‚

åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè®¿é—®è€…æ¨¡å¼èƒ½è®©ä½ çš„ä»£ç ï¼š
- ä»"æ“ä½œé€»è¾‘æ•£è½åœ¨å„ä¸ªå…ƒç´ ç±»ä¸­"å˜æˆ"æ“ä½œé›†ä¸­åœ¨è®¿é—®è€…ä¸­"
- ä»"æ–°å¢æ“ä½œè¦æ”¹æ‰€æœ‰ç±»"å˜æˆ"æ–°å¢è®¿é—®è€…å³å¯"
- ä»"èŒè´£ä¸æ¸…"å˜æˆ"æ•°æ®ä¸æ“ä½œåˆ†ç¦»"

**è®°ä½ä¸€å¥è¯**ï¼šå½“ä½ æœ‰ä¸€ä¸ªç¨³å®šçš„æ•°æ®ç»“æ„ï¼Œéœ€è¦å¯¹å®ƒæ‰§è¡Œå¤šç§æ“ä½œæ—¶ï¼Œå°±è¯¥è€ƒè™‘è®¿é—®è€…æ¨¡å¼äº†ï¼

---

> ğŸ’¡ **æ€è€ƒé¢˜**ï¼š
> 1. ä¸ºä»€ä¹ˆè®¿é—®è€…æ¨¡å¼æ˜“äºæ·»åŠ æ–°æ“ä½œï¼Œä½†éš¾äºæ·»åŠ æ–°å…ƒç´ ï¼Ÿ
> 2. Babel çš„ AST éå†ä¸ºä»€ä¹ˆé€‚åˆç”¨è®¿é—®è€…æ¨¡å¼ï¼Ÿ
> 3. å¦‚ä½•åœ¨ä¸ç ´åå°è£…çš„å‰æä¸‹ä½¿ç”¨è®¿é—®è€…æ¨¡å¼ï¼Ÿ

---

> ğŸ“š **ç›¸å…³æ¨¡å¼**ï¼š
> - ç»„åˆæ¨¡å¼ï¼ˆCompositeï¼‰ï¼šå¸¸ä¸è®¿é—®è€…æ¨¡å¼ç»“åˆï¼Œç”¨äºéå†ç»„åˆç»“æ„
> - è¿­ä»£å™¨æ¨¡å¼ï¼ˆIteratorï¼‰ï¼šéƒ½æ¶‰åŠéå†ï¼Œä½†è®¿é—®è€…å…³æ³¨æ“ä½œï¼Œè¿­ä»£å™¨å…³æ³¨éå†é¡ºåº
> - ç­–ç•¥æ¨¡å¼ï¼ˆStrategyï¼‰ï¼šéƒ½æ¶‰åŠç®—æ³•ï¼Œä½†è®¿é—®è€…é€šè¿‡åŒé‡åˆ†æ´¾ï¼Œç­–ç•¥é€šè¿‡ç»„åˆ

