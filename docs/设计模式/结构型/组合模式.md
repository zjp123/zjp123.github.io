# ã€Šå‰ç«¯è®¾è®¡æ¨¡å¼å®æˆ˜æ‰‹å†Œã€‹

## ç¬¬å…«ç« ï¼šç»„åˆæ¨¡å¼ï¼ˆComposite Patternï¼‰

---

### ğŸ¯ ä¸€å¥è¯å¤§ç™½è¯

> **ç»„åˆæ¨¡å¼å°±åƒä¿„ç½—æ–¯å¥—å¨ƒï¼šå¤§å¥—å¨ƒé‡Œå¯ä»¥è£…å°å¥—å¨ƒï¼Œå°å¥—å¨ƒé‡Œè¿˜å¯ä»¥è£…æ›´å°çš„å¥—å¨ƒã€‚ä½†ä¸ç®¡æ˜¯å¤§å¥—å¨ƒè¿˜æ˜¯å°å¥—å¨ƒï¼Œä½ éƒ½å¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼"æ‰“å¼€"å®ƒä»¬ã€‚ç»„åˆæ¨¡å¼è®©"å•ä¸ªå¯¹è±¡"å’Œ"å¯¹è±¡ç»„åˆ"ç”¨èµ·æ¥ä¸€æ¨¡ä¸€æ ·ã€‚**

**æ ¸å¿ƒç†å¿µï¼šå°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤º"éƒ¨åˆ†-æ•´ä½“"çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚**

---

### ğŸ¤” ä»€ä¹ˆæ—¶å€™éœ€è¦"ç»„åˆ"ï¼Ÿ

åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°æ ‘å½¢ç»“æ„æˆ–åµŒå¥—ç»“æ„çš„åœºæ™¯ï¼š

| åœºæ™¯ | ä¸ºä»€ä¹ˆéœ€è¦ç»„åˆæ¨¡å¼ |
|------|------------------|
| **æ ‘å½¢èœå•** | èœå•é¡¹å¯ä»¥æ˜¯å•ä¸ªé¡¹ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒ…å«å­èœå•çš„é¡¹ |
| **è¡¨å•å­—æ®µ** | è¡¨å•å¯ä»¥æ˜¯å•ä¸ªå­—æ®µï¼Œä¹Ÿå¯ä»¥æ˜¯å­—æ®µç»„ |
| **ç»„ä»¶æ ‘** | React ç»„ä»¶æ ‘æœ¬èº«å°±æ˜¯ç»„åˆæ¨¡å¼ |
| **æ–‡ä»¶ç³»ç»Ÿ** | æ–‡ä»¶å¤¹å¯ä»¥åŒ…å«æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åŒ…å«å­æ–‡ä»¶å¤¹ |
| **æƒé™æ ‘** | æƒé™å¯ä»¥æ˜¯å•ä¸ªæƒé™ï¼Œä¹Ÿå¯ä»¥æ˜¯æƒé™ç»„ |
| **è¯„è®ºåµŒå¥—** | è¯„è®ºå¯ä»¥å›å¤è¯„è®ºï¼Œå½¢æˆåµŒå¥—ç»“æ„ |
| **ç»„ç»‡æ¶æ„** | éƒ¨é—¨å¯ä»¥åŒ…å«å‘˜å·¥ï¼Œä¹Ÿå¯ä»¥åŒ…å«å­éƒ¨é—¨ |

---

### ğŸ˜« å‰ç«¯ç—›ç‚¹ï¼šæ²¡æœ‰ç»„åˆæ¨¡å¼æ—¶çš„å™©æ¢¦

#### åœºæ™¯ä¸€ï¼šèœå•ç»“æ„æ··ä¹±

```tsx
// âŒ å™©æ¢¦ä»£ç ï¼šèœå•é¡¹å’Œèœå•ç»„åˆ†å¼€å¤„ç†

interface MenuItem {
  id: string;
  label: string;
  onClick: () => void;
}

interface MenuGroup {
  id: string;
  label: string;
  children: (MenuItem | MenuGroup)[];  // æ··åˆç±»å‹ï¼Œéš¾ä»¥å¤„ç†
}

// æ¸²æŸ“èœå•æ—¶ï¼Œéœ€è¦åˆ¤æ–­ç±»å‹
const renderMenu = (item: MenuItem | MenuGroup) => {
  if ('children' in item) {
    // æ˜¯èœå•ç»„
    return (
      <SubMenu title={item.label}>
        {item.children.map(child => renderMenu(child))}  // é€’å½’ï¼Œä½†ç±»å‹ä¸ç»Ÿä¸€
      </SubMenu>
    );
  } else {
    // æ˜¯èœå•é¡¹
    return <Menu.Item onClick={item.onClick}>{item.label}</Menu.Item>;
  }
};

// é—®é¢˜ï¼š
// 1. ç±»å‹åˆ¤æ–­å¤æ‚
// 2. æ·»åŠ æ–°ç±»å‹éœ€è¦æ”¹å¾ˆå¤šåœ°æ–¹
// 3. æ— æ³•ç»Ÿä¸€å¤„ç†
```

#### åœºæ™¯äºŒï¼šè¡¨å•å­—æ®µå¤„ç†å¤æ‚

```tsx
// âŒ å™©æ¢¦ä»£ç ï¼šå•ä¸ªå­—æ®µå’Œå­—æ®µç»„åˆ†å¼€å¤„ç†

interface FormField {
  name: string;
  type: 'input' | 'select';
  label: string;
}

interface FormGroup {
  title: string;
  fields: FormField[];
  groups?: FormGroup[];  // åµŒå¥—ç»„
}

// è·å–è¡¨å•å€¼æ—¶ï¼Œéœ€è¦é€’å½’å¤„ç†
const getFormValues = (group: FormGroup): Record<string, any> => {
  const values: Record<string, any> = {};
  
  // å¤„ç†å½“å‰ç»„çš„å­—æ®µ
  group.fields.forEach(field => {
    values[field.name] = getFieldValue(field.name);
  });
  
  // å¤„ç†å­ç»„
  if (group.groups) {
    group.groups.forEach(subGroup => {
      Object.assign(values, getFormValues(subGroup));
    });
  }
  
  return values;
};

// é—®é¢˜ï¼š
// 1. å•ä¸ªå­—æ®µå’Œå­—æ®µç»„å¤„ç†æ–¹å¼ä¸åŒ
// 2. åµŒå¥—å±‚çº§æ·±æ—¶ï¼Œä»£ç å¤æ‚
// 3. æ— æ³•ç»Ÿä¸€æ“ä½œ
```

#### åœºæ™¯ä¸‰ï¼šæƒé™æ£€æŸ¥é‡å¤ä»£ç 

```tsx
// âŒ å™©æ¢¦ä»£ç ï¼šå•ä¸ªæƒé™å’Œæƒé™ç»„åˆ†å¼€æ£€æŸ¥

interface Permission {
  code: string;
  check: () => boolean;
}

interface PermissionGroup {
  code: string;
  permissions: Permission[];
  groups?: PermissionGroup[];
  operator: 'AND' | 'OR';  // ç»„å†…æƒé™çš„å…³ç³»
}

// æ£€æŸ¥æƒé™æ—¶ï¼Œéœ€è¦åŒºåˆ†ç±»å‹
const hasPermission = (item: Permission | PermissionGroup): boolean => {
  if ('permissions' in item) {
    // æ˜¯æƒé™ç»„
    const results = item.permissions.map(p => p.check());
    
    if (item.groups) {
      results.push(...item.groups.map(g => hasPermission(g)));
    }
    
    return item.operator === 'AND'
      ? results.every(r => r)
      : results.some(r => r);
  } else {
    // æ˜¯å•ä¸ªæƒé™
    return item.check();
  }
};

// é—®é¢˜ï¼š
// 1. ç±»å‹åˆ¤æ–­å¤æ‚
// 2. é€»è¾‘é‡å¤
// 3. éš¾ä»¥æ‰©å±•
```

**è¿™äº›ä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ**

| é—®é¢˜ | æè¿° |
|------|------|
| ğŸ”´ **ç±»å‹åˆ¤æ–­å¤æ‚** | éœ€è¦åŒºåˆ†å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡ |
| ğŸ”´ **å¤„ç†æ–¹å¼ä¸ç»Ÿä¸€** | å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡å¤„ç†é€»è¾‘ä¸åŒ |
| ğŸ”´ **ä»£ç é‡å¤** | ç›¸ä¼¼çš„å¤„ç†é€»è¾‘é‡å¤å†™ |
| ğŸ”´ **éš¾ä»¥æ‰©å±•** | æ·»åŠ æ–°ç±»å‹éœ€è¦æ”¹å¾ˆå¤šåœ°æ–¹ |

---

### ğŸ’¡ æ¨¡å¼æ ¸å¿ƒæ¦‚å¿µ

ç»„åˆæ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š

> **å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤º"éƒ¨åˆ†-æ•´ä½“"çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚**

ç”¨å¤§ç™½è¯è¯´å°±æ˜¯ï¼š
- **ç»„ä»¶ï¼ˆComponentï¼‰**ï¼šå®šä¹‰ç»Ÿä¸€çš„æ¥å£ï¼Œå¯ä»¥æ˜¯å¶å­èŠ‚ç‚¹æˆ–å®¹å™¨èŠ‚ç‚¹
- **å¶å­ï¼ˆLeafï¼‰**ï¼šå•ä¸ªå¯¹è±¡ï¼Œæ²¡æœ‰å­èŠ‚ç‚¹
- **å®¹å™¨ï¼ˆCompositeï¼‰**ï¼šç»„åˆå¯¹è±¡ï¼ŒåŒ…å«å­èŠ‚ç‚¹
- **å®¢æˆ·ç«¯ï¼ˆClientï¼‰**ï¼šé€šè¿‡ç»Ÿä¸€æ¥å£æ“ä½œï¼Œä¸éœ€è¦åŒºåˆ†æ˜¯å¶å­è¿˜æ˜¯å®¹å™¨

**ç»„åˆæ¨¡å¼çš„ç»“æ„ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Component     â”‚  â† ç»Ÿä¸€æ¥å£
â”‚  (ç»„ä»¶æ¥å£)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + operation()   â”‚
â”‚ + add()         â”‚
â”‚ + remove()      â”‚
â”‚ + getChild()    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–²
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Leaf   â”‚ â”‚ Compositeâ”‚
â”‚ (å¶å­)   â”‚ â”‚ (å®¹å™¨)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚+operate â”‚ â”‚+operate   â”‚
â”‚         â”‚ â”‚+add()     â”‚
â”‚         â”‚ â”‚+remove()  â”‚
â”‚         â”‚ â”‚children[] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç±»æ¯”ç†è§£ï¼š**

```
æ²¡æœ‰ç»„åˆæ¨¡å¼ï¼šå¤„ç†æ–‡ä»¶å’Œå¤„ç†æ–‡ä»¶å¤¹çš„ä»£ç å®Œå…¨ä¸åŒ
æœ‰ç»„åˆæ¨¡å¼ï¼šæ–‡ä»¶å’Œæ–‡ä»¶å¤¹éƒ½ç”¨åŒæ ·çš„æ–¹å¼å¤„ç†ï¼ˆæ‰“å¼€ã€åˆ é™¤ã€ç§»åŠ¨ï¼‰
```

---

### ğŸ”§ å‰ç«¯å®æˆ˜æ¡ˆä¾‹ä¸€ï¼šæ ‘å½¢èœå•ç»„ä»¶

#### åœºæ™¯æè¿°

å®ç°ä¸€ä¸ªæ ‘å½¢èœå•ç³»ç»Ÿï¼Œèœå•é¡¹å¯ä»¥æ˜¯å•ä¸ªé¡¹ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒ…å«å­èœå•çš„é¡¹ï¼Œç»Ÿä¸€å¤„ç†ã€‚

```tsx
// composite/MenuComponent.ts

/**
 * èœå•ç»„ä»¶æ¥å£ï¼ˆComponentï¼‰
 * 
 * å®šä¹‰èœå•é¡¹çš„ç»Ÿä¸€æ¥å£
 */
export interface MenuComponent {
  /**
   * è·å–èœå• ID
   */
  getId(): string;
  
  /**
   * è·å–èœå•æ ‡ç­¾
   */
  getLabel(): string;
  
  /**
   * è·å–èœå•å›¾æ ‡
   */
  getIcon?: () => React.ReactNode;
  
  /**
   * æ¸²æŸ“èœå•é¡¹
   */
  render(): React.ReactNode;
  
  /**
   * æŸ¥æ‰¾èœå•é¡¹
   */
  find(id: string): MenuComponent | null;
  
  /**
   * è·å–æ‰€æœ‰èœå•é¡¹ï¼ˆæ‰å¹³åŒ–ï¼‰
   */
  getAllItems(): MenuComponent[];
  
  /**
   * æ£€æŸ¥æ˜¯å¦æ¿€æ´»
   */
  isActive?(currentPath: string): boolean;
}

/**
 * èœå•é¡¹ï¼ˆLeafï¼‰
 * 
 * å•ä¸ªèœå•é¡¹ï¼Œæ²¡æœ‰å­èœå•
 */
export class MenuItem implements MenuComponent {
  constructor(
    private id: string,
    private label: string,
    private path: string,
    private icon?: () => React.ReactNode,
    private onClick?: () => void
  ) {}
  
  getId(): string {
    return this.id;
  }
  
  getLabel(): string {
    return this.label;
  }
  
  getIcon() {
    return this.icon?.();
  }
  
  isActive(currentPath: string): boolean {
    return this.path === currentPath;
  }
  
  render(): React.ReactNode {
    return (
      <Menu.Item
        key={this.id}
        onClick={this.onClick}
        className={this.isActive(window.location.pathname) ? 'active' : ''}
      >
        {this.getIcon()}
        <span>{this.label}</span>
      </Menu.Item>
    );
  }
  
  find(id: string): MenuComponent | null {
    return this.id === id ? this : null;
  }
  
  getAllItems(): MenuComponent[] {
    return [this];
  }
}
```

```tsx
// composite/MenuGroup.tsx

import React from 'react';
import { Menu } from 'antd';
import { MenuComponent } from './MenuComponent';

const { SubMenu } = Menu;

/**
 * èœå•ç»„ï¼ˆCompositeï¼‰
 * 
 * åŒ…å«å­èœå•çš„èœå•é¡¹
 */
export class MenuGroup implements MenuComponent {
  private children: MenuComponent[] = [];
  
  constructor(
    private id: string,
    private label: string,
    private icon?: () => React.ReactNode
  ) {}
  
  /**
   * æ·»åŠ å­èœå•
   */
  add(component: MenuComponent): void {
    this.children.push(component);
  }
  
  /**
   * ç§»é™¤å­èœå•
   */
  remove(component: MenuComponent): void {
    const index = this.children.indexOf(component);
    if (index > -1) {
      this.children.splice(index, 1);
    }
  }
  
  /**
   * è·å–å­èœå•
   */
  getChildren(): MenuComponent[] {
    return this.children;
  }
  
  getId(): string {
    return this.id;
  }
  
  getLabel(): string {
    return this.label;
  }
  
  getIcon() {
    return this.icon?.();
  }
  
  /**
   * æ¸²æŸ“èœå•ç»„
   * 
   * é€’å½’æ¸²æŸ“æ‰€æœ‰å­èœå•
   */
  render(): React.ReactNode {
    return (
      <SubMenu
        key={this.id}
        title={
          <span>
            {this.getIcon()}
            <span>{this.label}</span>
          </span>
        }
      >
        {this.children.map(child => child.render())}
      </SubMenu>
    );
  }
  
  /**
   * æŸ¥æ‰¾èœå•é¡¹
   * 
   * é€’å½’æŸ¥æ‰¾å­èœå•
   */
  find(id: string): MenuComponent | null {
    if (this.id === id) {
      return this;
    }
    
    for (const child of this.children) {
      const found = child.find(id);
      if (found) {
        return found;
      }
    }
    
    return null;
  }
  
  /**
   * è·å–æ‰€æœ‰èœå•é¡¹ï¼ˆæ‰å¹³åŒ–ï¼‰
   */
  getAllItems(): MenuComponent[] {
    const items: MenuComponent[] = [this];
    
    for (const child of this.children) {
      items.push(...child.getAllItems());
    }
    
    return items;
  }
  
  /**
   * æ£€æŸ¥æ˜¯å¦æœ‰æ¿€æ´»çš„å­èœå•
   */
  isActive(currentPath: string): boolean {
    return this.children.some(child => child.isActive?.(currentPath));
  }
}
```

```tsx
// composite/MenuBuilder.ts

import { MenuItem } from './MenuComponent';
import { MenuGroup } from './MenuGroup';

/**
 * èœå•æ„å»ºå™¨
 * 
 * æä¾›ä¾¿æ·çš„ API æ„å»ºèœå•ç»“æ„
 */
export class MenuBuilder {
  /**
   * åˆ›å»ºèœå•é¡¹
   */
  static item(
    id: string,
    label: string,
    path: string,
    icon?: () => React.ReactNode,
    onClick?: () => void
  ): MenuItem {
    return new MenuItem(id, label, path, icon, onClick);
  }
  
  /**
   * åˆ›å»ºèœå•ç»„
   */
  static group(
    id: string,
    label: string,
    icon?: () => React.ReactNode
  ): MenuGroup {
    return new MenuGroup(id, label, icon);
  }
}
```

#### ä¸šåŠ¡ä¸­ä½¿ç”¨

```tsx
// components/AppMenu.tsx

import React from 'react';
import { Menu } from 'antd';
import { MenuComponent } from '../composite/MenuComponent';
import { MenuBuilder } from '../composite/MenuBuilder';
import {
  UserOutlined,
  FileOutlined,
  SettingOutlined,
  DashboardOutlined,
} from '@ant-design/icons';

export const AppMenu: React.FC = () => {
  // âœ… æ„å»ºèœå•ç»“æ„ï¼ˆå¯ä»¥æ˜¯å•ä¸ªé¡¹ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»„ï¼‰
  const menuRoot = MenuBuilder.group('root', 'ä¸»èœå•');
  
  // ä»ªè¡¨ç›˜ï¼ˆå•ä¸ªé¡¹ï¼‰
  const dashboard = MenuBuilder.item(
    'dashboard',
    'ä»ªè¡¨ç›˜',
    '/dashboard',
    () => <DashboardOutlined />
  );
  menuRoot.add(dashboard);
  
  // ç”¨æˆ·ç®¡ç†ï¼ˆç»„ï¼‰
  const userGroup = MenuBuilder.group('users', 'ç”¨æˆ·ç®¡ç†', () => <UserOutlined />);
  userGroup.add(MenuBuilder.item('user-list', 'ç”¨æˆ·åˆ—è¡¨', '/users'));
  userGroup.add(MenuBuilder.item('user-role', 'è§’è‰²ç®¡ç†', '/users/roles'));
  menuRoot.add(userGroup);
  
  // æ–‡ä»¶ç®¡ç†ï¼ˆç»„ï¼‰
  const fileGroup = MenuBuilder.group('files', 'æ–‡ä»¶ç®¡ç†', () => <FileOutlined />);
  fileGroup.add(MenuBuilder.item('file-list', 'æ–‡ä»¶åˆ—è¡¨', '/files'));
  fileGroup.add(MenuBuilder.item('file-upload', 'ä¸Šä¼ æ–‡ä»¶', '/files/upload'));
  menuRoot.add(fileGroup);
  
  // è®¾ç½®ï¼ˆå•ä¸ªé¡¹ï¼‰
  const settings = MenuBuilder.item(
    'settings',
    'è®¾ç½®',
    '/settings',
    () => <SettingOutlined />
  );
  menuRoot.add(settings);
  
  // âœ… ç»Ÿä¸€æ¸²æŸ“ï¼Œä¸éœ€è¦åŒºåˆ†æ˜¯é¡¹è¿˜æ˜¯ç»„
  return (
    <Menu mode="inline" theme="dark">
      {menuRoot.getChildren().map(child => child.render())}
    </Menu>
  );
};

// æŸ¥æ‰¾èœå•é¡¹
const menuItem = menuRoot.find('user-list');
if (menuItem) {
  console.log('æ‰¾åˆ°èœå•é¡¹:', menuItem.getLabel());
}

// è·å–æ‰€æœ‰èœå•é¡¹ï¼ˆæ‰å¹³åŒ–ï¼‰
const allItems = menuRoot.getAllItems();
console.log('æ‰€æœ‰èœå•é¡¹:', allItems.map(item => item.getLabel()));
```

---

### ğŸ”§ å‰ç«¯å®æˆ˜æ¡ˆä¾‹äºŒï¼šè¡¨å•å­—æ®µç»„åˆ

#### åœºæ™¯æè¿°

å®ç°ä¸€ä¸ªè¡¨å•ç³»ç»Ÿï¼Œå­—æ®µå¯ä»¥æ˜¯å•ä¸ªå­—æ®µï¼Œä¹Ÿå¯ä»¥æ˜¯å­—æ®µç»„ï¼Œç»Ÿä¸€å¤„ç†ã€‚

```tsx
// composite/FormComponent.ts

import React from 'react';
import { Form } from 'antd';

/**
 * è¡¨å•ç»„ä»¶æ¥å£ï¼ˆComponentï¼‰
 */
export interface FormComponent {
  /**
   * è·å–å­—æ®µå
   */
  getName(): string;
  
  /**
   * è·å–å­—æ®µæ ‡ç­¾
   */
  getLabel(): string;
  
  /**
   * æ¸²æŸ“è¡¨å•å­—æ®µ
   */
  render(form: any): React.ReactNode;
  
  /**
   * è·å–å­—æ®µå€¼
   */
  getValue(formValues: Record<string, any>): any;
  
  /**
   * è®¾ç½®å­—æ®µå€¼
   */
  setValue(formValues: Record<string, any>, value: any): void;
  
  /**
   * éªŒè¯å­—æ®µ
   */
  validate(formValues: Record<string, any>): Promise<string | null>;
  
  /**
   * è·å–æ‰€æœ‰å­—æ®µåï¼ˆæ‰å¹³åŒ–ï¼‰
   */
  getAllNames(): string[];
}

/**
 * è¡¨å•å­—æ®µï¼ˆLeafï¼‰
 */
export class FormField implements FormComponent {
  constructor(
    private name: string,
    private label: string,
    private type: 'input' | 'select' | 'date' | 'textarea',
    private rules?: Array<{ required?: boolean; message?: string; validator?: (value: any) => boolean }>,
    private options?: Array<{ label: string; value: any }>
  ) {}
  
  getName(): string {
    return this.name;
  }
  
  getLabel(): string {
    return this.label;
  }
  
  render(form: any): React.ReactNode {
    const rules = this.rules?.map(rule => ({
      required: rule.required,
      message: rule.message || `è¯·è¾“å…¥${this.label}`,
      validator: rule.validator,
    }));
    
    switch (this.type) {
      case 'input':
        return (
          <Form.Item name={this.name} label={this.label} rules={rules}>
            <input />
          </Form.Item>
        );
      case 'select':
        return (
          <Form.Item name={this.name} label={this.label} rules={rules}>
            <select>
              {this.options?.map(opt => (
                <option key={opt.value} value={opt.value}>
                  {opt.label}
                </option>
              ))}
            </select>
          </Form.Item>
        );
      case 'textarea':
        return (
          <Form.Item name={this.name} label={this.label} rules={rules}>
            <textarea />
          </Form.Item>
        );
      default:
        return null;
    }
  }
  
  getValue(formValues: Record<string, any>): any {
    return formValues[this.name];
  }
  
  setValue(formValues: Record<string, any>, value: any): void {
    formValues[this.name] = value;
  }
  
  async validate(formValues: Record<string, any>): Promise<string | null> {
    const value = this.getValue(formValues);
    
    if (this.rules) {
      for (const rule of this.rules) {
        if (rule.required && (value === undefined || value === null || value === '')) {
          return rule.message || `${this.label}æ˜¯å¿…å¡«é¡¹`;
        }
        
        if (rule.validator && !rule.validator(value)) {
          return rule.message || `${this.label}éªŒè¯å¤±è´¥`;
        }
      }
    }
    
    return null;
  }
  
  getAllNames(): string[] {
    return [this.name];
  }
}
```

```tsx
// composite/FormGroup.tsx

import React from 'react';
import { Card } from 'antd';
import { FormComponent } from './FormComponent';

/**
 * è¡¨å•ç»„ï¼ˆCompositeï¼‰
 */
export class FormGroup implements FormComponent {
  private children: FormComponent[] = [];
  
  constructor(
    private name: string,
    private label: string,
    private collapsible: boolean = false
  ) {}
  
  add(component: FormComponent): void {
    this.children.push(component);
  }
  
  remove(component: FormComponent): void {
    const index = this.children.indexOf(component);
    if (index > -1) {
      this.children.splice(index, 1);
    }
  }
  
  getChildren(): FormComponent[] {
    return this.children;
  }
  
  getName(): string {
    return this.name;
  }
  
  getLabel(): string {
    return this.label;
  }
  
  render(form: any): React.ReactNode {
    const content = this.children.map(child => child.render(form));
    
    if (this.collapsible) {
      return (
        <Card
          key={this.name}
          title={this.label}
          style={{ marginBottom: 16 }}
        >
          {content}
        </Card>
      );
    }
    
    return (
      <div key={this.name} style={{ marginBottom: 16 }}>
        <h3>{this.label}</h3>
        {content}
      </div>
    );
  }
  
  getValue(formValues: Record<string, any>): any {
    const value: Record<string, any> = {};
    
    for (const child of this.children) {
      value[child.getName()] = child.getValue(formValues);
    }
    
    return value;
  }
  
  setValue(formValues: Record<string, any>, value: Record<string, any>): void {
    for (const child of this.children) {
      const childName = child.getName();
      if (value[childName] !== undefined) {
        child.setValue(formValues, value[childName]);
      }
    }
  }
  
  async validate(formValues: Record<string, any>): Promise<string | null> {
    for (const child of this.children) {
      const error = await child.validate(formValues);
      if (error) {
        return error;
      }
    }
    return null;
  }
  
  getAllNames(): string[] {
    const names: string[] = [];
    
    for (const child of this.children) {
      names.push(...child.getAllNames());
    }
    
    return names;
  }
}
```

#### ä¸šåŠ¡ä¸­ä½¿ç”¨

```tsx
// components/UserForm.tsx

import React from 'react';
import { Form, Button } from 'antd';
import { FormComponent } from '../composite/FormComponent';
import { FormField } from '../composite/FormComponent';
import { FormGroup } from '../composite/FormGroup';

export const UserForm: React.FC = () => {
  const [form] = Form.useForm();
  
  // âœ… æ„å»ºè¡¨å•ç»“æ„
  const formRoot = new FormGroup('root', 'ç”¨æˆ·ä¿¡æ¯');
  
  // åŸºæœ¬ä¿¡æ¯ç»„
  const basicGroup = new FormGroup('basic', 'åŸºæœ¬ä¿¡æ¯', true);
  basicGroup.add(new FormField('name', 'å§“å', 'input', [
    { required: true, message: 'è¯·è¾“å…¥å§“å' },
  ]));
  basicGroup.add(new FormField('email', 'é‚®ç®±', 'input', [
    { required: true, message: 'è¯·è¾“å…¥é‚®ç®±' },
    { validator: (value) => /^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(value) },
  ]));
  formRoot.add(basicGroup);
  
  // è”ç³»ä¿¡æ¯ç»„
  const contactGroup = new FormGroup('contact', 'è”ç³»ä¿¡æ¯', true);
  contactGroup.add(new FormField('phone', 'ç”µè¯', 'input'));
  contactGroup.add(new FormField('address', 'åœ°å€', 'textarea'));
  formRoot.add(contactGroup);
  
  // è§’è‰²å­—æ®µï¼ˆå•ä¸ªå­—æ®µï¼‰
  formRoot.add(new FormField('role', 'è§’è‰²', 'select', [
    { required: true },
  ], [
    { label: 'ç®¡ç†å‘˜', value: 'admin' },
    { label: 'ç”¨æˆ·', value: 'user' },
  ]));
  
  const handleSubmit = async () => {
    const values = form.getFieldsValue();
    
    // âœ… ç»Ÿä¸€éªŒè¯ï¼Œä¸éœ€è¦åŒºåˆ†æ˜¯å­—æ®µè¿˜æ˜¯ç»„
    const error = await formRoot.validate(values);
    if (error) {
      console.error('éªŒè¯å¤±è´¥:', error);
      return;
    }
    
    console.log('æäº¤æ•°æ®:', formRoot.getValue(values));
  };
  
  return (
    <Form form={form}>
      {/* âœ… ç»Ÿä¸€æ¸²æŸ“ */}
      {formRoot.getChildren().map(child => child.render(form))}
      
      <Form.Item>
        <Button type="primary" onClick={handleSubmit}>
          æäº¤
        </Button>
      </Form.Item>
    </Form>
  );
};
```

---

### ğŸ”§ å‰ç«¯å®æˆ˜æ¡ˆä¾‹ä¸‰ï¼šæƒé™æ ‘ç»„åˆ

#### åœºæ™¯æè¿°

å®ç°ä¸€ä¸ªæƒé™ç³»ç»Ÿï¼Œæƒé™å¯ä»¥æ˜¯å•ä¸ªæƒé™ï¼Œä¹Ÿå¯ä»¥æ˜¯æƒé™ç»„ï¼Œç»Ÿä¸€æ£€æŸ¥ã€‚

```tsx
// composite/PermissionComponent.ts

/**
 * æƒé™ç»„ä»¶æ¥å£ï¼ˆComponentï¼‰
 */
export interface PermissionComponent {
  /**
   * è·å–æƒé™ä»£ç 
   */
  getCode(): string;
  
  /**
   * è·å–æƒé™åç§°
   */
  getName(): string;
  
  /**
   * æ£€æŸ¥æƒé™
   */
  check(userPermissions: string[]): boolean;
  
  /**
   * è·å–æ‰€æœ‰æƒé™ä»£ç ï¼ˆæ‰å¹³åŒ–ï¼‰
   */
  getAllCodes(): string[];
}

/**
 * æƒé™ï¼ˆLeafï¼‰
 */
export class Permission implements PermissionComponent {
  constructor(
    private code: string,
    private name: string
  ) {}
  
  getCode(): string {
    return this.code;
  }
  
  getName(): string {
    return this.name;
  }
  
  check(userPermissions: string[]): boolean {
    return userPermissions.includes(this.code);
  }
  
  getAllCodes(): string[] {
    return [this.code];
  }
}
```

```tsx
// composite/PermissionGroup.ts

import { PermissionComponent } from './PermissionComponent';

/**
 * æƒé™ç»„ï¼ˆCompositeï¼‰
 */
export class PermissionGroup implements PermissionComponent {
  private children: PermissionComponent[] = [];
  
  constructor(
    private code: string,
    private name: string,
    private operator: 'AND' | 'OR' = 'OR'
  ) {}
  
  add(component: PermissionComponent): void {
    this.children.push(component);
  }
  
  remove(component: PermissionComponent): void {
    const index = this.children.indexOf(component);
    if (index > -1) {
      this.children.splice(index, 1);
    }
  }
  
  getChildren(): PermissionComponent[] {
    return this.children;
  }
  
  getCode(): string {
    return this.code;
  }
  
  getName(): string {
    return this.name;
  }
  
  /**
   * æ£€æŸ¥æƒé™
   * 
   * ANDï¼šæ‰€æœ‰å­æƒé™éƒ½å¿…é¡»æœ‰
   * ORï¼šä»»æ„ä¸€ä¸ªå­æƒé™æœ‰å³å¯
   */
  check(userPermissions: string[]): boolean {
    if (this.children.length === 0) {
      return false;
    }
    
    const results = this.children.map(child => child.check(userPermissions));
    
    return this.operator === 'AND'
      ? results.every(r => r)
      : results.some(r => r);
  }
  
  getAllCodes(): string[] {
    const codes: string[] = [this.code];
    
    for (const child of this.children) {
      codes.push(...child.getAllCodes());
    }
    
    return codes;
  }
}
```

#### ä¸šåŠ¡ä¸­ä½¿ç”¨

```tsx
// services/permissionService.ts

import { PermissionComponent } from '../composite/PermissionComponent';
import { Permission } from '../composite/PermissionComponent';
import { PermissionGroup } from '../composite/PermissionGroup';

/**
 * æƒé™æœåŠ¡
 */
export class PermissionService {
  private permissionTree: PermissionGroup;
  
  constructor() {
    // âœ… æ„å»ºæƒé™æ ‘
    this.permissionTree = new PermissionGroup('root', 'æ‰€æœ‰æƒé™');
    
    // ç”¨æˆ·ç®¡ç†æƒé™ç»„
    const userGroup = new PermissionGroup('user', 'ç”¨æˆ·ç®¡ç†', 'OR');
    userGroup.add(new Permission('user:view', 'æŸ¥çœ‹ç”¨æˆ·'));
    userGroup.add(new Permission('user:create', 'åˆ›å»ºç”¨æˆ·'));
    userGroup.add(new Permission('user:edit', 'ç¼–è¾‘ç”¨æˆ·'));
    userGroup.add(new Permission('user:delete', 'åˆ é™¤ç”¨æˆ·'));
    this.permissionTree.add(userGroup);
    
    // è®¢å•ç®¡ç†æƒé™ç»„
    const orderGroup = new PermissionGroup('order', 'è®¢å•ç®¡ç†', 'OR');
    orderGroup.add(new Permission('order:view', 'æŸ¥çœ‹è®¢å•'));
    orderGroup.add(new Permission('order:create', 'åˆ›å»ºè®¢å•'));
    orderGroup.add(new Permission('order:edit', 'ç¼–è¾‘è®¢å•'));
    this.permissionTree.add(orderGroup);
    
    // ç³»ç»Ÿè®¾ç½®æƒé™ï¼ˆå•ä¸ªæƒé™ï¼‰
    this.permissionTree.add(new Permission('system:settings', 'ç³»ç»Ÿè®¾ç½®'));
  }
  
  /**
   * æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æƒé™
   * 
   * âœ… ç»Ÿä¸€æ¥å£ï¼Œä¸éœ€è¦åŒºåˆ†æ˜¯å•ä¸ªæƒé™è¿˜æ˜¯æƒé™ç»„
   */
  hasPermission(userPermissions: string[], permissionCode: string): boolean {
    const permission = this.findPermission(permissionCode);
    if (!permission) {
      return false;
    }
    
    return permission.check(userPermissions);
  }
  
  /**
   * æŸ¥æ‰¾æƒé™
   */
  private findPermission(code: string): PermissionComponent | null {
    return this.permissionTree.getAllCodes().includes(code)
      ? this.findInTree(this.permissionTree, code)
      : null;
  }
  
  private findInTree(
    component: PermissionComponent,
    code: string
  ): PermissionComponent | null {
    if (component.getCode() === code) {
      return component;
    }
    
    if (component instanceof PermissionGroup) {
      for (const child of component.getChildren()) {
        const found = this.findInTree(child, code);
        if (found) {
          return found;
        }
      }
    }
    
    return null;
  }
  
  /**
   * è·å–æ‰€æœ‰æƒé™ä»£ç 
   */
  getAllPermissions(): string[] {
    return this.permissionTree.getAllCodes();
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const permissionService = new PermissionService();

const userPermissions = ['user:view', 'user:create', 'order:view'];

// âœ… æ£€æŸ¥å•ä¸ªæƒé™
console.log(permissionService.hasPermission(userPermissions, 'user:view'));  // true

// âœ… æ£€æŸ¥æƒé™ç»„ï¼ˆè‡ªåŠ¨å¤„ç†ç»„å†…é€»è¾‘ï¼‰
console.log(permissionService.hasPermission(userPermissions, 'user'));  // true (OR é€»è¾‘)

// âœ… æ£€æŸ¥ä¸å­˜åœ¨çš„æƒé™
console.log(permissionService.hasPermission(userPermissions, 'system:settings'));  // false
```

---

### ğŸ”§ å‰ç«¯å®æˆ˜æ¡ˆä¾‹å››ï¼šè¯„è®ºåµŒå¥—ç»“æ„

#### åœºæ™¯æè¿°

å®ç°ä¸€ä¸ªè¯„è®ºç³»ç»Ÿï¼Œè¯„è®ºå¯ä»¥å›å¤è¯„è®ºï¼Œå½¢æˆåµŒå¥—ç»“æ„ã€‚

```tsx
// composite/CommentComponent.tsx

import React, { useState } from 'react';
import { Avatar, Button, Input } from 'antd';

/**
 * è¯„è®ºç»„ä»¶æ¥å£ï¼ˆComponentï¼‰
 */
export interface CommentComponent {
  /**
   * è·å–è¯„è®º ID
   */
  getId(): string;
  
  /**
   * è·å–è¯„è®ºå†…å®¹
   */
  getContent(): string;
  
  /**
   * è·å–ä½œè€…
   */
  getAuthor(): { name: string; avatar?: string };
  
  /**
   * è·å–åˆ›å»ºæ—¶é—´
   */
  getCreatedAt(): Date;
  
  /**
   * æ¸²æŸ“è¯„è®º
   */
  render(depth?: number): React.ReactNode;
  
  /**
   * æ·»åŠ å›å¤
   */
  addReply(reply: CommentComponent): void;
  
  /**
   * è·å–æ‰€æœ‰è¯„è®ºï¼ˆæ‰å¹³åŒ–ï¼‰
   */
  getAllComments(): CommentComponent[];
  
  /**
   * è·å–å›å¤æ•°é‡
   */
  getReplyCount(): number;
}
```

```tsx
// composite/Comment.tsx

import React, { useState } from 'react';
import { Avatar, Button, Input } from 'antd';
import { CommentComponent } from './CommentComponent';

/**
 * è¯„è®ºï¼ˆLeaf/Compositeï¼‰
 * 
 * æ—¢å¯ä»¥ä½œä¸ºå¶å­èŠ‚ç‚¹ï¼ˆæ²¡æœ‰å›å¤ï¼‰ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå®¹å™¨èŠ‚ç‚¹ï¼ˆæœ‰å›å¤ï¼‰
 */
export class Comment implements CommentComponent {
  private replies: Comment[] = [];
  
  constructor(
    private id: string,
    private content: string,
    private author: { name: string; avatar?: string },
    private createdAt: Date = new Date()
  ) {}
  
  getId(): string {
    return this.id;
  }
  
  getContent(): string {
    return this.content;
  }
  
  getAuthor() {
    return this.author;
  }
  
  getCreatedAt(): Date {
    return this.createdAt;
  }
  
  addReply(reply: Comment): void {
    this.replies.push(reply);
  }
  
  getReplies(): Comment[] {
    return this.replies;
  }
  
  getReplyCount(): number {
    let count = this.replies.length;
    for (const reply of this.replies) {
      count += reply.getReplyCount();
    }
    return count;
  }
  
  render(depth: number = 0): React.ReactNode {
    const [isReplying, setIsReplying] = useState(false);
    const [replyContent, setReplyContent] = useState('');
    
    const handleReply = () => {
      if (!replyContent.trim()) return;
      
      const newReply = new Comment(
        `reply_${Date.now()}`,
        replyContent,
        { name: 'å½“å‰ç”¨æˆ·' },
        new Date()
      );
      
      this.addReply(newReply);
      setReplyContent('');
      setIsReplying(false);
    };
    
    return (
      <div
        key={this.id}
        style={{
          marginLeft: depth * 40,
          marginBottom: 16,
          padding: 12,
          border: '1px solid #f0f0f0',
          borderRadius: 8,
        }}
      >
        <div style={{ display: 'flex', alignItems: 'flex-start' }}>
          <Avatar src={this.author.avatar}>{this.author.name[0]}</Avatar>
          <div style={{ marginLeft: 12, flex: 1 }}>
            <div style={{ fontWeight: 'bold', marginBottom: 4 }}>
              {this.author.name}
            </div>
            <div style={{ marginBottom: 8 }}>{this.content}</div>
            <div style={{ fontSize: 12, color: '#999', marginBottom: 8 }}>
              {this.createdAt.toLocaleString()}
            </div>
            
            {!isReplying ? (
              <Button
                size="small"
                onClick={() => setIsReplying(true)}
              >
                å›å¤
              </Button>
            ) : (
              <div>
                <Input.TextArea
                  value={replyContent}
                  onChange={(e) => setReplyContent(e.target.value)}
                  placeholder="è¾“å…¥å›å¤..."
                  rows={2}
                  style={{ marginBottom: 8 }}
                />
                <div>
                  <Button size="small" onClick={handleReply}>
                    æäº¤
                  </Button>
                  <Button
                    size="small"
                    onClick={() => {
                      setIsReplying(false);
                      setReplyContent('');
                    }}
                    style={{ marginLeft: 8 }}
                  >
                    å–æ¶ˆ
                  </Button>
                </div>
              </div>
            )}
          </div>
        </div>
        
        {/* âœ… é€’å½’æ¸²æŸ“å›å¤ */}
        {this.replies.length > 0 && (
          <div style={{ marginTop: 16 }}>
            {this.replies.map(reply => reply.render(depth + 1))}
          </div>
        )}
      </div>
    );
  }
  
  getAllComments(): CommentComponent[] {
    const comments: CommentComponent[] = [this];
    
    for (const reply of this.replies) {
      comments.push(...reply.getAllComments());
    }
    
    return comments;
  }
}
```

#### ä¸šåŠ¡ä¸­ä½¿ç”¨

```tsx
// components/CommentList.tsx

import React, { useState } from 'react';
import { Comment } from '../composite/Comment';

export const CommentList: React.FC = () => {
  const [comments, setComments] = useState<Comment[]>([
    new Comment(
      '1',
      'è¿™æ˜¯ä¸€æ¡è¯„è®º',
      { name: 'å¼ ä¸‰', avatar: 'https://via.placeholder.com/40' },
      new Date('2024-01-01')
    ),
    new Comment(
      '2',
      'è¿™æ˜¯å¦ä¸€æ¡è¯„è®º',
      { name: 'æå››', avatar: 'https://via.placeholder.com/40' },
      new Date('2024-01-02')
    ),
  ]);
  
  // æ·»åŠ å›å¤åˆ°ç¬¬ä¸€æ¡è¯„è®º
  const handleAddReply = () => {
    const comment1 = comments[0];
    const reply = new Comment(
      `reply_${Date.now()}`,
      'è¿™æ˜¯å¯¹ç¬¬ä¸€æ¡è¯„è®ºçš„å›å¤',
      { name: 'ç‹äº”' },
      new Date()
    );
    
    comment1.addReply(reply);
    setComments([...comments]);
  };
  
  // âœ… ç»Ÿä¸€æ¸²æŸ“ï¼Œè‡ªåŠ¨å¤„ç†åµŒå¥—
  return (
    <div>
      <h2>è¯„è®ºåˆ—è¡¨</h2>
      <div>æ€»è¯„è®ºæ•°: {comments.reduce((sum, c) => sum + c.getReplyCount() + 1, 0)}</div>
      
      {comments.map(comment => comment.render())}
      
      <Button onClick={handleAddReply}>æ·»åŠ å›å¤</Button>
    </div>
  );
};
```

---

### ğŸ“Š æ¨¡å¼æ€»ç»“

#### âœ… ä¼˜ç‚¹

| ä¼˜ç‚¹ | è¯´æ˜ |
|------|------|
| **ç»Ÿä¸€æ¥å£** | å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡ä½¿ç”¨ç›¸åŒçš„æ¥å£ |
| **ç®€åŒ–å®¢æˆ·ç«¯** | å®¢æˆ·ç«¯ä¸éœ€è¦åŒºåˆ†æ˜¯å¶å­è¿˜æ˜¯å®¹å™¨ |
| **æ˜“äºæ‰©å±•** | æ·»åŠ æ–°ç±»å‹çš„ç»„ä»¶å¾ˆå®¹æ˜“ |
| **é€’å½’å¤„ç†** | å¤©ç„¶æ”¯æŒæ ‘å½¢ç»“æ„çš„é€’å½’æ“ä½œ |
| **çµæ´»ç»„åˆ** | å¯ä»¥çµæ´»ç»„åˆä¸åŒçš„ç»„ä»¶ |

#### âŒ ç¼ºç‚¹

| ç¼ºç‚¹ | è¯´æ˜ |
|------|------|
| **è®¾è®¡å¤æ‚** | éœ€è¦è®¾è®¡ç»Ÿä¸€çš„æ¥å£ï¼Œå¯èƒ½è¿‡åº¦è®¾è®¡ |
| **ç±»å‹å®‰å…¨** | TypeScript ä¸­å¤„ç†ç»„åˆç±»å‹å¯èƒ½å¤æ‚ |
| **æ€§èƒ½è€ƒè™‘** | æ·±å±‚åµŒå¥—æ—¶ï¼Œé€’å½’æ“ä½œå¯èƒ½æœ‰æ€§èƒ½é—®é¢˜ |

#### ğŸ¯ é€‚ç”¨åœºæ™¯

| åœºæ™¯ | ç¤ºä¾‹ |
|------|------|
| **æ ‘å½¢ç»“æ„** | èœå•æ ‘ã€æ–‡ä»¶ç³»ç»Ÿã€ç»„ç»‡æ¶æ„ |
| **åµŒå¥—ç»“æ„** | è¯„è®ºåµŒå¥—ã€è¡¨å•å­—æ®µç»„ |
| **ç»Ÿä¸€æ“ä½œ** | æƒé™æ£€æŸ¥ã€æ•°æ®æ”¶é›†ã€æ¸²æŸ“ |
| **é€’å½’å¤„ç†** | éœ€è¦é€’å½’éå†çš„åœºæ™¯ |

#### ğŸš« ä¸é€‚ç”¨åœºæ™¯

- ç»“æ„ç®€å•ï¼Œä¸éœ€è¦æ ‘å½¢ç»“æ„
- å¶å­èŠ‚ç‚¹å’Œå®¹å™¨èŠ‚ç‚¹è¡Œä¸ºå·®å¼‚å¾ˆå¤§
- æ€§èƒ½è¦æ±‚æé«˜ï¼Œé€’å½’å¼€é”€ä¸å¯æ¥å—

---

### ğŸ”„ ä¸å…¶ä»–æ¨¡å¼çš„åŒºåˆ«

| æ¨¡å¼ | å…³æ³¨ç‚¹ | åŒºåˆ« |
|------|--------|------|
| **ç»„åˆæ¨¡å¼** | æ ‘å½¢ç»“æ„ | ç»Ÿä¸€å¤„ç†å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡ |
| **è£…é¥°å™¨æ¨¡å¼** | åŠŸèƒ½å¢å¼º | åŠ¨æ€æ·»åŠ åŠŸèƒ½ |
| **ç­–ç•¥æ¨¡å¼** | ç®—æ³•é€‰æ‹© | å°è£…ç®—æ³• |
| **è®¿é—®è€…æ¨¡å¼** | æ“ä½œåˆ†ç¦» | å°†æ“ä½œä»å¯¹è±¡ç»“æ„ä¸­åˆ†ç¦» |

---

### ğŸ¤” é€‰æ‹©å»ºè®®ï¼šä»€ä¹ˆæ—¶å€™ç”¨ç»„åˆæ¨¡å¼ï¼Ÿ

é—®è‡ªå·±è¿™å‡ ä¸ªé—®é¢˜ï¼š

```
1. ä½ çš„æ•°æ®ç»“æ„æ˜¯å¦æ˜¯æ ‘å½¢çš„ï¼Ÿ
   â†’ æ˜¯çš„è¯ï¼Œè€ƒè™‘ç»„åˆæ¨¡å¼

2. ä½ æ˜¯å¦éœ€è¦å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡è¿›è¡Œç»Ÿä¸€æ“ä½œï¼Ÿ
   â†’ æ˜¯çš„è¯ï¼Œè€ƒè™‘ç»„åˆæ¨¡å¼

3. ä½ æ˜¯å¦éœ€è¦é€’å½’å¤„ç†åµŒå¥—ç»“æ„ï¼Ÿ
   â†’ æ˜¯çš„è¯ï¼Œè€ƒè™‘ç»„åˆæ¨¡å¼

4. å®¢æˆ·ç«¯æ˜¯å¦éœ€è¦åŒºåˆ†å¶å­èŠ‚ç‚¹å’Œå®¹å™¨èŠ‚ç‚¹ï¼Ÿ
   â†’ å¦‚æœä¸éœ€è¦ï¼Œè€ƒè™‘ç»„åˆæ¨¡å¼

5. ä½ çš„ç»“æ„æ˜¯å¦ä¼šåŠ¨æ€å˜åŒ–ï¼ˆæ·»åŠ /åˆ é™¤èŠ‚ç‚¹ï¼‰ï¼Ÿ
   â†’ å¦‚æœæ˜¯ï¼Œè€ƒè™‘ç»„åˆæ¨¡å¼
```

---

### ğŸ“ æ–‡ä»¶ç»“æ„å‚è€ƒ

```
src/
â”œâ”€â”€ composite/
â”‚   â”œâ”€â”€ MenuComponent.ts            # èœå•ç»„ä»¶æ¥å£
â”‚   â”œâ”€â”€ MenuItem.ts                 # èœå•é¡¹ï¼ˆLeafï¼‰
â”‚   â”œâ”€â”€ MenuGroup.tsx               # èœå•ç»„ï¼ˆCompositeï¼‰
â”‚   â”œâ”€â”€ MenuBuilder.ts              # èœå•æ„å»ºå™¨
â”‚   â”œâ”€â”€ FormComponent.ts            # è¡¨å•ç»„ä»¶æ¥å£
â”‚   â”œâ”€â”€ FormField.ts                # è¡¨å•å­—æ®µï¼ˆLeafï¼‰
â”‚   â”œâ”€â”€ FormGroup.tsx               # è¡¨å•ç»„ï¼ˆCompositeï¼‰
â”‚   â”œâ”€â”€ PermissionComponent.ts       # æƒé™ç»„ä»¶æ¥å£
â”‚   â”œâ”€â”€ Permission.ts                # æƒé™ï¼ˆLeafï¼‰
â”‚   â”œâ”€â”€ PermissionGroup.ts          # æƒé™ç»„ï¼ˆCompositeï¼‰
â”‚   â”œâ”€â”€ CommentComponent.tsx        # è¯„è®ºç»„ä»¶æ¥å£
â”‚   â””â”€â”€ Comment.tsx                 # è¯„è®ºï¼ˆLeaf/Compositeï¼‰
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ AppMenu.tsx                 # ä½¿ç”¨èœå•ç»„åˆ
â”‚   â”œâ”€â”€ UserForm.tsx                # ä½¿ç”¨è¡¨å•ç»„åˆ
â”‚   â””â”€â”€ CommentList.tsx             # ä½¿ç”¨è¯„è®ºç»„åˆ
â””â”€â”€ services/
    â””â”€â”€ permissionService.ts        # ä½¿ç”¨æƒé™ç»„åˆ
```

---

> **ä¸‹ä¸€ç« é¢„å‘Šï¼šã€Šè£…é¥°å™¨æ¨¡å¼ã€‹â€”â€” ç»™åŠŸèƒ½"åŠ æ–™"çš„æ­£ç¡®å§¿åŠ¿**
> 
> æˆ‘ä»¬å°†è®²è§£å¦‚ä½•é€šè¿‡è£…é¥°å™¨æ¨¡å¼å¢å¼ºç»„ä»¶åŠŸèƒ½ã€æ·»åŠ æƒé™æ§åˆ¶ã€æ—¥å¿—è®°å½•ç­‰ã€‚

---

*å¦‚æœ‰ç–‘é—®æˆ–å»ºè®®ï¼Œæ¬¢è¿äº¤æµï¼*

